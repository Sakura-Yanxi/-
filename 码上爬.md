# 码上爬爬虫刷题平台
## 1.动态数据采集
#### 题目很简单，只需要拼接页码参数就可以，防盗链都可以不加
```python
import requests

url = 'https://www.mashangpa.com/api/problem-detail/1/data/?page={}'

headers = {
    'user-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36 Edg/138.0.0.0',
    'cookie':'Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0=1754540935,1754553617; HMACCOUNT=FA452653B0C48E17; sessionid=4ggoy1g3gv9afiw75ikg54aimt7r8xv5; Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0=1754553655',
    'referer':'https://www.mashangpa.com/',
}

list = []
for i in range(1,21):
    r = requests.get(url.format(i), headers=headers).json()
    list += r['current_array']
print(list)
print(sum(list))
```
## 2.headers请求头验证
#### 题目很简单，只需要加入防盗链等，拼接页码参数就可以
```python
import requests
url = 'https://www.mashangpa.com/api/problem-detail/2/data/?'
list = []
headers = {
    'cookie':'Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0=1754540935,1754553617; HMACCOUNT=FA452653B0C48E17; sessionid=4ggoy1g3gv9afiw75ikg54aimt7r8xv5; Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0=1754554890',
    'referer':'https://www.mashangpa.com/problem-detail/2/',
    'user-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36 Edg/138.0.0.0'
}
for i in range(1,21):
    params = {
        'page': i
    }
    response = requests.get(url, headers=headers,params=params).json()
    list += response['current_array']
print(list)
print(sum(list))
```
## 3.浏览器调试
#### 题目有反扒机制可以通过把浏览器弹窗弹出，或者直接进行本地文件的替换。抓到包之后爬取数据就很简单了。
```python
import requests
url = 'https://www.mashangpa.com/api/problem-detail/3/data/?'

list = []
headers = {
    'cookie':'Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0=1754540935,1754553617; HMACCOUNT=FA452653B0C48E17; sessionid=4ggoy1g3gv9afiw75ikg54aimt7r8xv5; Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0=1754554890',
    'referer':'https://www.mashangpa.com/problem-detail/2/',
    'user-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36 Edg/138.0.0.0'
}
for i in range(1,21):
    params = {
        'page': i
    }
    response = requests.get(url, headers=headers,params=params).json()
    list += response['current_array']
print(list)
print(sum(list))
```
## 4.js逆向入门
#### 经过对请求头的观察发现并没有加密，负载中请求参数中有sign和ts的加密，检查调用的堆栈中的loadPage，很容易就发现是md5加密。在控制台中进行检验是否为正常的md5，最后发现为正常的md5加密。最后可以通过python里面的hashlib进行还原。
```python
import hashlib
import requests
import time

url = 'https://www.mashangpa.com/api/problem-detail/4/data/'
headers = {
    'user-agent':'/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36 Edg/138.0.0.0',
    'referer':'https://www.mashangpa.com/problem-detail/4/',
    'cookie':'sessionid=4ggoy1g3gv9afiw75ikg54aimt7r8xv5; Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0=1754557068,1754557358,1754557402,1754557770; HMACCOUNT=FA452653B0C48E17; Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0=1754557772'
}
list = []
def get_sign(page,_ts):
    string = "tuling" + _ts + str(page)
    sign = hashlib.md5(string.encode('utf-8')).hexdigest()
    return sign
for i in range(1,21):
    _ts = str(int(time.time()) * 1000)
    sign = get_sign(i,_ts)
    params = {
        'page':i,
        'sign':sign,
        '_ts':_ts
    }
    resp = requests.get(url,params=params,headers=headers).json()
    current_array = resp['current_array']
    list +=current_array
print(list)
print(sum(list))
```
## 5.屠龙刀
####  经过对请求头的观察发现并没有加密，负载中请求参数中有xl的加密检查调用的堆栈中的loadPage，很容易就发现是AES加密。
```js
const CryptoJS = require('crypto-js')
const _0x38addf = _0x66a7
function _0x66a7(_0x7461a9, _0x14ffcc) {
    const _0x4f0d09 = _0x4f0d();
    return _0x66a7 = function (_0x66a780, _0x2abc15) {
        _0x66a780 = _0x66a780 - 0xc5;
        let _0x477d8f = _0x4f0d09[_0x66a780];
        return _0x477d8f;
    }, _0x66a7(_0x7461a9, _0x14ffcc);
}
function _0x4f0d() {
    const _0x341c37 = ['2440720SaQcQw', 'jo8j9wGw%6HbxfFn', '9735516pjwmiO', '68862pbatqQ', 'mode', 'AES', '1923264HnviQd', '36906bPsIrd', '12hEJHOd', 'enc', 'pad', 'encrypt', 'Hex', 'Utf8', '689460JbShaf', 'parse', '957060HmuxSn', 'toString', '445UZKyxv'];
    _0x4f0d = function () {
        return _0x341c37;
    };
    return _0x4f0d();
}
let key = CryptoJS.enc.Utf8.parse("jo8j9wGw%6HbxfFn"),
    iv = CryptoJS.enc.Utf8.parse('0123456789ABCDEF');

function encrypt(_0x277028) {
    const _0x4d843e = _0x38addf;
    const jsonStr = JSON.stringify(_0x277028, null, 0).replace(/\s+/g, '')
    let _0x2703a2 = CryptoJS.enc.Utf8.parse(jsonStr),
        _0x50fcf0 = CryptoJS.AES.encrypt(_0x2703a2, key, {
            'mode': CryptoJS.mode.CBC,
            'padding': CryptoJS.pad.Pkcs7,
            'iv': iv
        });
    return(_0x50fcf0['ciphertext']["toString"](CryptoJS.enc.Hex))
    // console.log(_0x50fcf0['ciphertext']["toString"](CryptoJS.enc.Hex)) ;
}
// encrypt({"page":2,"_ts":1759588122496})
```
```python
import execjs
import requests
import json
import time

headers = {
    "origin": "https://www.mashangpa.com",
    "priority": "u=1, i",
    "referer": "https://www.mashangpa.com/problem-detail/5/",
    "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36 Edg/141.0.0.0"
}
with open('1.js','r',encoding='utf-8') as f:
    ctx = execjs.compile(f.read())
cookies = {
    "sessionid": "28xvqtouyogiovqb2hxbujws2rkkrruz",
    "Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0": "1758285094,1758635100,1758681400,1759586129",
    "HMACCOUNT": "FA452653B0C48E17",
    "Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0": "1759587778"
}
url = "https://www.mashangpa.com/api/problem-detail/5/data/"
list = []
for i in range(1,21):
    params = {
    'page':i,
    '_ts' : int(time.time()*1000)
    }
    data = {
        "xl": ctx.call('encrypt',params),
    }
    data = json.dumps(data, separators=(',', ':'))
    response = requests.post(url, headers=headers, cookies=cookies, data=data).json()
    print(response)
    list += response["current_array"]
    time.sleep(0.5)
print(sum(list))
```
## 6.倚天剑
#### 经过观察为简单的请求头加密分别为s和tt，并且对响应内容response进行加密。通过分析loadPage里面的源代码很容易就可以进行js还原，但是要注意在还原加密参数时不要再js里面用json还原最终结果
```js
function xxxxoooo(encryptedHex) {
    let enccc = dd.a.enc.Hex.parse(encryptedHex);
    let deccc = dd.a.AES["decr" + "ypt"]({ciphertext: enccc}, kkkk, {
        mode: dd.a.mode.CBC,
        padding: dd.a.pad.Pkcs7,
        iv: iiii,
    });
    // console.log(JSON.parse(deccc.toString(dd.a.enc.Utf8)))
    // return JSON.parse(deccc.toString(dd.a.enc.Utf8));
    return deccc.toString(dd.a.enc.Utf8)
}
function r(n, r) {
        var t = (65535 & n) + (65535 & r);
        return (n >> 16) + (r >> 16) + (t >> 16) << 16 | 65535 & t
    }
function t(n, t, o, u, e, c) {
        return r(function (n, r) {
            return n << e | n >>> 32 - e
        }(r(r(t, n), r(u, c))), o)
    }
function o(n, r, o, u, e, c, f) {
        return t(r & o | ~r & u, n, r, e, c, f)
    }
function u(n, r, o, u, e, c, f) {
        return t(r & u | o & ~u, n, r, e, c, f)
    }
function e(n, r, o, u, e, c, f) {
        return t(r ^ o ^ u, n, r, e, c, f)
    }
function c(n, r, o, u, e, c, f) {
        return t(o ^ (r | ~u), n, r, e, c, f)
    }
function a(n) {
        var r, t = [];
        for (t[(n.length >> 2) - 1] = void 0, r = 0; r < t.length; r += 1) t[r] = 0;
        var o = 8 * n.length;
        for (r = 0; r < o; r += 8) t[r >> 5] |= (255 & n.charCodeAt(r / 8)) << r % 32;
        return t
    }
function f(n, t) {
        var f, i, a, h, g;
        n[t >> 5] |= 128 << t % 32, n[14 + (t + 64 >>> 9 << 4)] = t;
        var l = 1732584193, d = -271733879, v = -1732584194, C = 271733878;
        for (f = 0; f < n.length; f += 16) d = c(d = c(d = c(d = c(d = e(d = e(d = e(d = e(d = u(d = u(d = u(d = u(d = o(d = o(d = o(d = o(a = d, v = o(h = v, C = o(g = C, l = o(i = l, d, v, C, n[f], 7, -680876936), d, v, n[f + 1], 12, -389564586), l, d, n[f + 2], 17, 606105819), C, l, n[f + 3], 22, -1044525330), v = o(v, C = o(C, l = o(l, d, v, C, n[f + 4], 7, -176418897), d, v, n[f + 5], 12, 1200080426), l, d, n[f + 6], 17, -1473231341), C, l, n[f + 7], 22, -45705983), v = o(v, C = o(C, l = o(l, d, v, C, n[f + 8], 7, 1770035416), d, v, n[f + 9], 12, -1958414417), l, d, n[f + 10], 17, -42063), C, l, n[f + 11], 22, -1990404162), v = o(v, C = o(C, l = o(l, d, v, C, n[f + 12], 7, 1804603682), d, v, n[f + 13], 12, -40341101), l, d, n[f + 14], 17, -1502002290), C, l, n[f + 15], 22, 1236535329), v = u(v, C = u(C, l = u(l, d, v, C, n[f + 1], 5, -165796510), d, v, n[f + 6], 9, -1069501632), l, d, n[f + 11], 14, 643717713), C, l, n[f], 20, -373897302), v = u(v, C = u(C, l = u(l, d, v, C, n[f + 5], 5, -701558691), d, v, n[f + 10], 9, 38016083), l, d, n[f + 15], 14, -660478335), C, l, n[f + 4], 20, -405537848), v = u(v, C = u(C, l = u(l, d, v, C, n[f + 9], 5, 568446438), d, v, n[f + 14], 9, -1019803690), l, d, n[f + 3], 14, -187363961), C, l, n[f + 8], 20, 1163531501), v = u(v, C = u(C, l = u(l, d, v, C, n[f + 13], 5, -1444681467), d, v, n[f + 2], 9, -51403784), l, d, n[f + 7], 14, 1735328473), C, l, n[f + 12], 20, -1926607734), v = e(v, C = e(C, l = e(l, d, v, C, n[f + 5], 4, -378558), d, v, n[f + 8], 11, -2022574463), l, d, n[f + 11], 16, 1839030562), C, l, n[f + 14], 23, -35309556), v = e(v, C = e(C, l = e(l, d, v, C, n[f + 1], 4, -1530992060), d, v, n[f + 4], 11, 1272893353), l, d, n[f + 7], 16, -155497632), C, l, n[f + 10], 23, -1094730640), v = e(v, C = e(C, l = e(l, d, v, C, n[f + 13], 4, 681279174), d, v, n[f], 11, -358537222), l, d, n[f + 3], 16, -722521979), C, l, n[f + 6], 23, 76029189), v = e(v, C = e(C, l = e(l, d, v, C, n[f + 9], 4, -640364487), d, v, n[f + 12], 11, -421815835), l, d, n[f + 15], 16, 530742520), C, l, n[f + 2], 23, -995338651), v = c(v, C = c(C, l = c(l, d, v, C, n[f], 6, -198630844), d, v, n[f + 7], 10, 1126891415), l, d, n[f + 14], 15, -1416354905), C, l, n[f + 5], 21, -57434055), v = c(v, C = c(C, l = c(l, d, v, C, n[f + 12], 6, 1700485571), d, v, n[f + 3], 10, -1894986606), l, d, n[f + 10], 15, -1051523), C, l, n[f + 1], 21, -2054922799), v = c(v, C = c(C, l = c(l, d, v, C, n[f + 8], 6, 1873313359), d, v, n[f + 15], 10, -30611744), l, d, n[f + 6], 15, -1560198380), C, l, n[f + 13], 21, 1309151649), v = c(v, C = c(C, l = c(l, d, v, C, n[f + 4], 6, -145523070), d, v, n[f + 11], 10, -1120210379), l, d, n[f + 2], 15, 718787259), C, l, n[f + 9], 21, -343485551), l = r(l, i), d = r(d, a), v = r(v, h), C = r(C, g);
        return [l, d, v, C]
    }
function i(n) {
        var r, t = "", o = 32 * n.length;
        for (r = 0; r < o; r += 8) t += String.fromCharCode(n[r >> 5] >>> r % 32 & 255);
        return t
    }
function g(n) {
        return unescape(encodeURIComponent(n))
    }
function l(n) {
        return function (n) {
            return i(f(a(n), 8 * n.length))
        }(g(n))
    }
function h(n) {
        var r, t, o = "0123456789abcdef", u = "";
        for (t = 0; t < n.length; t += 1) r = n.charCodeAt(t), u += o.charAt(r >>> 4 & 15) + o.charAt(15 & r);
        return u
    }
function xxoo (n, r, t) {
        return r ? t ? d(r, n) : function (n, r) {
            return h(d(n, r))
        }(r, n) : t ? l(n) : function (n) {
            return h(l(n))
        }(n)
    }
dd = {
    a: require('crypto-js')
}
let kkkk = dd.a.enc.Utf8.parse("xxxxxxxxoooooooo");
let iiii = dd.a.enc.Utf8.parse("0123456789ABCDEF");

function s() {
    let ttt = new Date().getTime();
    let  t= 1759653507488
    let token =xxoo("sssssbbbbb" + ttt)
    let hhh = {
        S: token,
        tt: ttt.toString(),
    }
    return (hhh)
    console.log(hhh)
}
// let tttt = '361d3626adcf4a361c385c8f0b39c963f0469b9c6ff6d23c7e0b145e1b885851be1cff3c2d5ef470376708d6f60fad1c4c9987e181d330ca77dc5cb91d0ab5c1680f095d61499b9023658e14181dee9f1345ad91df727ce58e869da5f59aef9df7f38b4730811ba0fe75bd3c2c95fdd5054eb1e57ee01817f2ade931100f307b497bc2b6dade4143419d9613f268f80283cdf202aba59e969fd8e4338e9678f4d5301e80407904687f5e0c68d4ba413d0a66dbc4f2758901aa4ff102be1b31aeea6d53acc884ea1abf6dba04fd8b9582027caf80badcefa2df46b1076ff883ed99aa1acd9860c7050a9e4ea36493a5b9f26ea29bd1bc5378f881856e9648ad3e977a57d33ffab33a406087a34ba40abd66859bb0f0328978c5ad97b43f3d8142724f9f051f4b276ec253da7fd33b0a3b9808d9de66d7215341d12ee729d80ba065e1c8c4ca907bc9fad229391908b230ee984ec636efaef129571c421edac6722968c25e452eafa2571e0c28f773ac5b5471883445ed951615fb5e7b167f20cc846c4736fd4c474394b07d0c7b0a4264cc02cc2dfe5599ce9410b785de0786840d522d9e29f17cce61f60ab90118fe72f224a7b202ab2dd31524fd2255331e1dfd373d3d73a65c761aebf6c53731a41e660a4075e651e44776b0a69a727b6704'
// xxxxoooo(tttt)
// console.log(tttt.length)

```
```python
import execjs
import requests
import json
import time

headers = {
    "origin": "https://www.mashangpa.com",
    "priority": "u=1, i",
    "referer": "https://www.mashangpa.com/problem-detail/5/",
    "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36 Edg/141.0.0.0"
}
with open('1.js','r',encoding='utf-8') as f:
    ctx = execjs.compile(f.read())
cookies = {
    "sessionid": "28xvqtouyogiovqb2hxbujws2rkkrruz",
    "Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0": "1758285094,1758635100,1758681400,1759586129",
    "HMACCOUNT": "FA452653B0C48E17",
    "Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0": "1759587778"
}
url = "https://www.mashangpa.com/api/problem-detail/5/data/"
list = []
for i in range(1,21):
    params = {
    'page':i,
    '_ts' : int(time.time()*1000)
    }
    data = {
        "xl": ctx.call('encrypt',params),
    }
    data = json.dumps(data, separators=(',', ':'))
    response = requests.post(url, headers=headers, cookies=cookies, data=data).json()
    print(response)
    list += response["current_array"]
    time.sleep(0.5)
print(sum(list))
```import requests
import execjs
import json


with open('1.js','r',encoding='utf-8') as f:
    ctx1 = execjs.compile(f.read())
    result1 = ctx1.call('s')
headers = {
    "accept": "*/*",
    "accept-language": "zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6",
    "cache-control": "no-cache",
    "pragma": "no-cache",
    "referer": "https://www.mashangpa.com/problem-detail/6/",
    "s": result1['S'],
    "tt":result1['tt'],
    "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36 Edg/141.0.0.0"
}
cookies = {
    "sessionid": "28xvqtouyogiovqb2hxbujws2rkkrruz",
    "Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0": "1758635100,1758681400,1759586129,1759652173",
    "HMACCOUNT": "FA452653B0C48E17",
    "Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0": "1759652183"
}
url = "https://www.mashangpa.com/api/problem-detail/6/data/"
list = []
for page in range(1,21):
    params = {
        "page": page
    }
    response = requests.get(url, headers=headers, cookies=cookies, params=params).json()
    t = str(response['t'])
    with open('1.js','r',encoding='utf-8') as f:
        ctx2 = execjs.compile(f.read())
        result2 = ctx2.call('xxxxoooo',t)
    response = json.loads(result2)
    print(response)
    list += response['current_array']
print(sum(list))
```
## 7.千山鸟飞绝
#### 经过观察为简单的请求头加密分别为m和ts，并且对响应内容response进行加密。通过分析loadPage里面的源代码很容易就可以进行js还原，但是要注意在还原加密参数时不要再js里面用json还原最终结果。加密eeee方法解密是xxxxoooo方法
```js
// 前半部分借鉴的阿尔法老师的 后半部分自己写的 因为再https://obf-io.deobfuscate.io/上面前部分解混淆是错误的。
const CryptoJS = require('crypto-js')
function eeee(_0x4e41fb, _0x151d45, _0x21b59a) {
    return _0x151d45 ? _0x21b59a ? _0x5333d7(_0x151d45, _0x4e41fb) : function (_0x32e6c1, _0x317277) {
      return _0x4646b5(_0x5333d7(_0x32e6c1, _0x317277));
    }(_0x151d45, _0x4e41fb) : _0x21b59a ? _0x3fdbf5(_0x4e41fb) : function (_0x5beac5) {
      return _0x4646b5(_0x3fdbf5(_0x5beac5));
    }(_0x4e41fb);
  };
function _0x4646b5(_0x15e082) {
    var _0x1ccbb8,
        _0x4bc150,
        _0x319430 = "0123456789abcdef",
        _0xca94ca = '';

    for (_0x4bc150 = 0; _0x4bc150 < _0x15e082["length"]; _0x4bc150 += 1) {
      _0x1ccbb8 = _0x15e082["charCodeAt"](_0x4bc150);
      _0xca94ca += _0x319430["charAt"](_0x1ccbb8 >>> 4 & 15) + _0x319430["charAt"](15 & _0x1ccbb8);
    }

    return _0xca94ca;
  };
function _0x3fdbf5(_0x15f5cd) {
    return function (_0x359016) {
      return _0x39f712(_0x4ca385(_0x19e0dd(_0x359016), 8 * _0x359016["length"]));
    }(_0x28dd2d(_0x15f5cd));
  };
function _0x28dd2d(_0xafa9b4) {
    return unescape(encodeURIComponent(_0xafa9b4));
  };
function _0x39f712(_0x46c2c6) {
    var _0x46b898,
        _0x5016fb = '',
        _0x3072e8 = 32 * _0x46c2c6["length"];

    for (_0x46b898 = 0; _0x46b898 < _0x3072e8; _0x46b898 += 8) {
      _0x5016fb += String["fromCharCode"](_0x46c2c6[_0x46b898 >> 5] >>> _0x46b898 % 32 & 255);
    }

    return _0x5016fb;
  };
function _0x4ca385(_0x2dc616, _0x307043) {
    var _0x5a7e07, _0xd5b683, _0x4cf87b, _0x13ac12, _0x3d4242;

    _0x2dc616[_0x307043 >> 5] |= 128 << _0x307043 % 32;
    _0x2dc616[14 + (_0x307043 + 64 >>> 9 << 4)] = _0x307043;

    var _0x2f897c = 1732584193,
        _0x58e914 = -271733879,
        _0x4fed8f = -1732584194,
        _0x16de2e = 271733878;

    for (_0x5a7e07 = 0; _0x5a7e07 < _0x2dc616["length"]; _0x5a7e07 += 16) {
      _0x58e914 = _0x4025ad(_0x58e914 = _0x4025ad(_0x58e914 = _0x4025ad(_0x58e914 = _0x4025ad(_0x58e914 = _0x456ee7(_0x58e914 = _0x456ee7(_0x58e914 = _0x456ee7(_0x58e914 = _0x456ee7(_0x58e914 = _0x2ee51e(_0x58e914 = _0x2ee51e(_0x58e914 = _0x2ee51e(_0x58e914 = _0x2ee51e(_0x58e914 = _0x37e5c4(_0x58e914 = _0x37e5c4(_0x58e914 = _0x37e5c4(_0x58e914 = _0x37e5c4(_0x4cf87b = _0x58e914, _0x4fed8f = _0x37e5c4(_0x13ac12 = _0x4fed8f, _0x16de2e = _0x37e5c4(_0x3d4242 = _0x16de2e, _0x2f897c = _0x37e5c4(_0xd5b683 = _0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07], 7, -680876936), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 1], 12, -389564586), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 2], 17, 606105819), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 3], 22, -1044525330), _0x4fed8f = _0x37e5c4(_0x4fed8f, _0x16de2e = _0x37e5c4(_0x16de2e, _0x2f897c = _0x37e5c4(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 4], 7, -176418897), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 5], 12, 1200080426), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 6], 17, -1473231341), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 7], 22, -45705983), _0x4fed8f = _0x37e5c4(_0x4fed8f, _0x16de2e = _0x37e5c4(_0x16de2e, _0x2f897c = _0x37e5c4(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 8], 7, 1770035416), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 9], 12, -1958414417), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 10], 17, -42063), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 11], 22, -1990404162), _0x4fed8f = _0x37e5c4(_0x4fed8f, _0x16de2e = _0x37e5c4(_0x16de2e, _0x2f897c = _0x37e5c4(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 12], 7, 1804603682), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 13], 12, -40341101), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 14], 17, -1502002290), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 15], 22, 1236535329), _0x4fed8f = _0x2ee51e(_0x4fed8f, _0x16de2e = _0x2ee51e(_0x16de2e, _0x2f897c = _0x2ee51e(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 1], 5, -165796510), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 6], 9, -1069501632), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 11], 14, 643717713), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07], 20, -373897302), _0x4fed8f = _0x2ee51e(_0x4fed8f, _0x16de2e = _0x2ee51e(_0x16de2e, _0x2f897c = _0x2ee51e(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 5], 5, -701558691), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 10], 9, 38016083), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 15], 14, -660478335), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 4], 20, -405537848), _0x4fed8f = _0x2ee51e(_0x4fed8f, _0x16de2e = _0x2ee51e(_0x16de2e, _0x2f897c = _0x2ee51e(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 9], 5, 568446438), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 14], 9, -1019803690), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 3], 14, -187363961), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 8], 20, 1163531501), _0x4fed8f = _0x2ee51e(_0x4fed8f, _0x16de2e = _0x2ee51e(_0x16de2e, _0x2f897c = _0x2ee51e(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 13], 5, -1444681467), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 2], 9, -51403784), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 7], 14, 1735328473), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 12], 20, -1926607734), _0x4fed8f = _0x456ee7(_0x4fed8f, _0x16de2e = _0x456ee7(_0x16de2e, _0x2f897c = _0x456ee7(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 5], 4, -378558), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 8], 11, -2022574463), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 11], 16, 1839030562), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 14], 23, -35309556), _0x4fed8f = _0x456ee7(_0x4fed8f, _0x16de2e = _0x456ee7(_0x16de2e, _0x2f897c = _0x456ee7(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 1], 4, -1530992060), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 4], 11, 1272893353), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 7], 16, -155497632), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 10], 23, -1094730640), _0x4fed8f = _0x456ee7(_0x4fed8f, _0x16de2e = _0x456ee7(_0x16de2e, _0x2f897c = _0x456ee7(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 13], 4, 681279174), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07], 11, -358537222), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 3], 16, -722521979), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 6], 23, 76029189), _0x4fed8f = _0x456ee7(_0x4fed8f, _0x16de2e = _0x456ee7(_0x16de2e, _0x2f897c = _0x456ee7(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 9], 4, -640364487), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 12], 11, -421815835), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 15], 16, 530742520), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 2], 23, -995338651), _0x4fed8f = _0x4025ad(_0x4fed8f, _0x16de2e = _0x4025ad(_0x16de2e, _0x2f897c = _0x4025ad(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07], 6, -198630844), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 7], 10, 1126891415), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 14], 15, -1416354905), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 5], 21, -57434055), _0x4fed8f = _0x4025ad(_0x4fed8f, _0x16de2e = _0x4025ad(_0x16de2e, _0x2f897c = _0x4025ad(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 12], 6, 1700485571), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 3], 10, -1894986606), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 10], 15, -1051523), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 1], 21, -2054922799), _0x4fed8f = _0x4025ad(_0x4fed8f, _0x16de2e = _0x4025ad(_0x16de2e, _0x2f897c = _0x4025ad(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 8], 6, 1873313359), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 15], 10, -30611744), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 6], 15, -1560198380), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 13], 21, 1309151649), _0x4fed8f = _0x4025ad(_0x4fed8f, _0x16de2e = _0x4025ad(_0x16de2e, _0x2f897c = _0x4025ad(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 4], 6, -145523070), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 11], 10, -1120210379), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 2], 15, 718787259), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 9], 21, -343485551);
      _0x2f897c = _0x42fcff(_0x2f897c, _0xd5b683);
      _0x58e914 = _0x42fcff(_0x58e914, _0x4cf87b);
      _0x4fed8f = _0x42fcff(_0x4fed8f, _0x13ac12);
      _0x16de2e = _0x42fcff(_0x16de2e, _0x3d4242);
    }

    return [_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e];
  };
function _0x19e0dd(_0xe66aef) {
    var _0x286c6a,
        _0x53584a = [];

    for (_0x53584a[(_0xe66aef["length"] >> 2) - 1] = void 0, _0x286c6a = 0; _0x286c6a < _0x53584a["length"]; _0x286c6a += 1) {
      _0x53584a[_0x286c6a] = 0;
    }

    var _0x29afd4 = 8 * _0xe66aef["length"];

    for (_0x286c6a = 0; _0x286c6a < _0x29afd4; _0x286c6a += 8) {
      _0x53584a[_0x286c6a >> 5] |= (255 & _0xe66aef["charCodeAt"](_0x286c6a / 8)) << _0x286c6a % 32;
    }

    return _0x53584a;
  };
function _0x4025ad(_0x551614, _0x3736d8, _0x3091a9, _0x5c8ce5, _0x29a596, _0x3e1797, _0x2a5aa9) {
    return _0x3d57b3(_0x3091a9 ^ (_0x3736d8 | ~_0x5c8ce5), _0x551614, _0x3736d8, _0x29a596, _0x3e1797, _0x2a5aa9);
  };
function _0x456ee7(_0x1ccf9c, _0xf3008c, _0x21c7c7, _0xa84375, _0xa121be, _0x5a76ec, _0x47fb6e) {
    return _0x3d57b3(_0xf3008c ^ _0x21c7c7 ^ _0xa84375, _0x1ccf9c, _0xf3008c, _0xa121be, _0x5a76ec, _0x47fb6e);
  };
function _0x2ee51e(_0x398952, _0x441c4e, _0x4c89ff, _0x5d836a, _0x967345, _0x474483, _0x369a2d) {
    return _0x3d57b3(_0x441c4e & _0x5d836a | _0x4c89ff & ~_0x5d836a, _0x398952, _0x441c4e, _0x967345, _0x474483, _0x369a2d);
  };
function _0x37e5c4(_0x4c79ac, _0x1bc981, _0x372a6a, _0x27faff, _0x563eb7, _0x118215, _0x4d4537) {
    return _0x3d57b3(_0x1bc981 & _0x372a6a | ~_0x1bc981 & _0x27faff, _0x4c79ac, _0x1bc981, _0x563eb7, _0x118215, _0x4d4537);
  };
function _0x3d57b3(_0x37dd5c, _0x241fbb, _0x41c5da, _0x29f9bb, _0x5c4414, _0x461224) {
    return _0x42fcff(function (_0x5961b3, _0x5d9435) {
      return _0x5961b3 << _0x5c4414 | _0x5961b3 >>> 32 - _0x5c4414;
    }(_0x42fcff(_0x42fcff(_0x241fbb, _0x37dd5c), _0x42fcff(_0x29f9bb, _0x461224))), _0x41c5da);
  }
function _0x42fcff(_0x2a4dbf, _0x1aac01) {
    var _0x4c862c = (65535 & _0x2a4dbf) + (65535 & _0x1aac01);

    return (_0x2a4dbf >> 16) + (_0x1aac01 >> 16) + (_0x4c862c >> 16) << 16 | 65535 & _0x4c862c;
  };

function get_data() {
  let _0x2498e1 = new Date()["getTime"](),
      _0x48003c = eeee("xialuo" + _0x2498e1);
  let m = _0x48003c;
  let ts = _0x2498e1;
  let x= encodeURIComponent(CryptoJS["SHA256"](_0x48003c + "xxoo"));
  return {
  'm': m,
  'ts': ts.toString(),
  'x': x}
}

const Oe = {
  a: CryptoJS
};
dd = Oe;
let kkkk = dd.a.enc.Utf8.parse("xxxxxxxxoooooooo");
let iiii = dd.a.enc.Utf8.parse("0123456789ABCDEF");
function xxxxoooo(M) {
  let Y = dd.a.enc.Hex.parse(M);
  const x = {
    ciphertext: Y
  };
  let I = dd.a.AES.decrypt(x, kkkk, {
    'mode': dd.a.mode.CBC,
    'padding': dd.a.pad.Pkcs7,
    'iv': iiii
  });
  return I.toString(dd.a.enc.Utf8);
}

function get_response(r){
    const B = xxxxoooo(r);
    return B;
}

```
```python
import requests
import execjs
import json
with open('4.js', 'r', encoding='utf-8') as f:
    ctx = execjs.compile(f.read())
    result = ctx.call('get_data')
headers = {
    "accept": "application/json, text/javascript, */*; q=0.01",
    "accept-language": "zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6",
    "cache-control": "no-cache",
    "m": result['m'],
    "pragma": "no-cache",
    "priority": "u=1, i",
    "referer": "https://www.mashangpa.com/problem-detail/7/",
    "ts": result['ts'],
    "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36 Edg/141.0.0.0",
    "x-requested-with": "XMLHttpRequest"
}
cookies = {
    "sessionid": "28xvqtouyogiovqb2hxbujws2rkkrruz",
    "Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0": "1758635100,1758681400,1759586129,1759652173",
    "HMACCOUNT": "FA452653B0C48E17",
    "Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0": "1759657690"
}
url = "https://www.mashangpa.com/api/problem-detail/7/data/"
list = []
for page in range(1, 21):
    params = {
        "page": "2",
        "x": result['x'],
    }
    response = requests.get(url, headers=headers, cookies=cookies, params=params)
    resp = response.json()['r']
    with open('4.js', 'r', encoding='utf-8') as f:
        ctx = execjs.compile(f.read())
        response = ctx.call('get_response',resp )
        response = json.loads(response)
        print(response)
        list += response['current_array']
print(sum(list))
```
## 8.迷踪步
#### 经过观察为简单的请求头加密分别为m和t。通过分析loadPage里面的源代码很容易就可以进行js还原，加密为OOOoOo方法和btoa方法
```js
function OOOoOo(_0x240504, _0x8eefdc) {
  const _0x3a3671 = _0x240504["split"](''),
        _0x1959d4 = _0x8eefdc["split"](''),
        _0x582226 = 4;

  let _0x5ad857 = [];

  for (let _0x2d33d3 = 0; _0x2d33d3 < _0x3a3671["length"]; _0x2d33d3 += _0x582226) {
    let _0x38ae5f = _0x3a3671["slice"](_0x2d33d3, _0x2d33d3 + _0x582226);

    for (let _0x31873b = 0; _0x31873b < _0x38ae5f["length"]; _0x31873b++) {
      const _0x11057a = _0x38ae5f[_0x31873b]["charCodeAt"](0),
            _0x1a6269 = _0x1959d4[_0x31873b % _0x1959d4["length"]]["charCodeAt"](0),
            _0x25c979 = (_0x11057a + _0x1a6269) % 256;

      _0x38ae5f[_0x31873b] = String["fromCharCode"](_0x25c979);
    }

    _0x5ad857 = _0x5ad857["concat"](_0x38ae5f);
  }

  const _0x28d8b9 = _0x5ad857["join"](''),
        _0x36bdd2 = Array["from"](_0x28d8b9)["map"](_0x3c7e7a => _0x3c7e7a["charCodeAt"](0)["toString"](16)["padStart"](2, "0"))["join"]('');

  return _0x36bdd2;
}


function Sakura(page){
    let time = new Date()['getTime']();
    let m = OOOoOo("oooooo" + time + page, "oooooo");
    let t = btoa(time);
    let result = {
        'm': m,
        't' : t,
    }
    return result
    // console.log(result);
}

```
```python
import execjs
import requests
import json


cookies = {
    "sessionid": "28xvqtouyogiovqb2hxbujws2rkkrruz",
    "Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0": "1758681400,1759586129,1759652173,1759756180",
    "HMACCOUNT": "FA452653B0C48E17",
    "Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0": "1759756219",
    "s": "51b351b351b351b370b0f071b0f0901010d0903051"
}
url = "https://www.mashangpa.com/api/problem-detail/8/data/"
list = []
for page in range(1,21):
    with open('4.js', 'r', encoding='utf-8') as f:
        ctx = execjs.compile(f.read())
        result = ctx.call('Sakura', page)
    headers = {
        "accept": "*/*",
        "accept-language": "zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6",
        "cache-control": "no-cache",
        "content-type": "application/json",
        "m": result['m'],
        "origin": "https://www.mashangpa.com",
        "pragma": "no-cache",
        "priority": "u=1, i",
        "referer": "https://www.mashangpa.com/problem-detail/8/",
        "t": result['t'],
        "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36 Edg/141.0.0.0",
        "x-requested-with": "XMLHttpRequest"
    }
    data = {
        "page": page
    }
    data = json.dumps(data, separators=(',', ':'))
    response = requests.post(url, headers=headers, cookies=cookies, data=data).json()
    print(response)
    list += response['current_array']
print(sum(list))
```
## 9.webpack调试
#### 请求载荷里面的m和tt的加密。观察调用的loadPage里面的源代码会发现n.data.m（下面有tt的加密位置）然后找c然后跳转会发现return dd.aa这个就是m的值，复现js代码就很简单了。
```js
const CryptosJS = require('crypto-js')
function get_data(){
  var f = (new Date)['getTime']();
  var m =CryptosJS.HmacSHA1('9527'+f.toString(),"xxxooo").toString()
  let result =  {
    m:m,
    tt:btoa(f)
  }
  console.log(result)
}
get_data()
```
```python
import requests,execjs,time
cookies = {
    'sessionid': '28xvqtouyogiovqb2hxbujws2rkkrruz',
    'Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0': '1757578955,1757900242,1758024154,1758030872',
    'HMACCOUNT': 'FA452653B0C48E17',
    'Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0': '1758031162',
}
url = 'https://www.mashangpa.com/api/problem-detail/9/data/'
headers = {
    'accept': '*/*',
    'accept-language': 'zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6',
    'cache-control': 'no-cache',
    'content-type': 'application/json',
    'origin': 'https://www.mashangpa.com',
    'pragma': 'no-cache',
    'priority': 'u=1, i',
    'referer': 'https://www.mashangpa.com/problem-detail/9/',
    'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Microsoft Edge";v="140"',
    'sec-ch-ua-mobile': '?0',
    'sec-ch-ua-platform': '"Windows"',
    'sec-fetch-dest': 'empty',
    'sec-fetch-mode': 'cors',
    'sec-fetch-site': 'same-origin',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36 Edg/140.0.0.0',
    'x-requested-with': 'XMLHttpRequest',
    # 'cookie': 'sessionid=28xvqtouyogiovqb2hxbujws2rkkrruz; Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0=1757578955,1757900242,1758024154,1758030872; HMACCOUNT=FA452653B0C48E17; Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0=1758031162',
}
with open('1.js', 'r', encoding='utf-8') as f:
    ctx = execjs.compile(f.read())
list = []
for page in range(1, 21):
    result = ctx.call('get_data')
    # print(result)
    data = {
        'm':result['m'],
        'tt':result['tt'],
        'page':page,
    }
    # print(data)
    response = requests.post(url, cookies=cookies, headers=headers, json=data).json()
    print(response)
    list += response["current_array"]
    time.sleep(1)
print(sum(list))
```
## 10.魔改算法
#### 经观察发现请求头位置并没有进行加密，在负载中发现有相应的t值加密，响应response中并没有加密。观察调用的load堆栈发现有ob混淆，并且不易发现加密生成位置，因此尝试进行解混淆[猿人学解混淆](https://tool.yuanrenxue.cn/decode_obfuscator).在解混淆的js代码中发现OOOO方法中调用的其他函数校对，因此尝试在浏览器中对此进行断点调试，并在其return返回值中发现其返回参数正是所对应的t值加密。因此即可进行扣js代码进行还原。
```js
const sakura = require('crypto-js')
function n(_0x4968e1, _0x1093ec, _0x4c5f59, _0x474b35, _0x353c24, _0xc168b9, _0x46b192) {
  _0x4968e1 = h(_0x4968e1, h(h(_0x4c5f59 ^ (_0x1093ec | ~_0x474b35), _0x353c24), _0x46b192));
  return h(_0x4968e1 << _0xc168b9 | _0x4968e1 >>> 32 - _0xc168b9, _0x1093ec);
}
function m(_0x130849, _0x4b0430, _0x4ba0ed, _0x4e52aa, _0x25e079, _0x56e69f, _0x40ef4c) {
  _0x130849 = h(_0x130849, h(h(_0x4b0430 ^ _0x4ba0ed ^ _0x4e52aa, _0x25e079), _0x40ef4c));
  return h(_0x130849 << _0x56e69f | _0x130849 >>> 32 - _0x56e69f, _0x4b0430);
}
function l(_0x4fcfd0, _0x791862, _0x545c62, _0x492884, _0x1b9409, _0x4f627e, _0x4c98ec) {
  _0x4fcfd0 = h(_0x4fcfd0, h(h(_0x791862 & _0x492884 | _0x545c62 & ~_0x492884, _0x1b9409), _0x4c98ec));
  return h(_0x4fcfd0 << _0x4f627e | _0x4fcfd0 >>> 32 - _0x4f627e, _0x791862);
}
function h(_0x26b5cf, _0x41a4dc) {
  var _0x27bd6f, _0x56c5bf, _0x1d88bb, _0x1629f5, _0x5ad387;

  _0x1d88bb = _0x26b5cf & 2147483648;
  _0x1629f5 = _0x41a4dc & 2147483648;
  _0x27bd6f = _0x26b5cf & 1073741824;
  _0x56c5bf = _0x41a4dc & 1073741824;
  _0x5ad387 = (_0x26b5cf & 1073741823) + (_0x41a4dc & 1073741823);
  return _0x27bd6f & _0x56c5bf ? _0x5ad387 ^ 2147483648 ^ _0x1d88bb ^ _0x1629f5 : _0x27bd6f | _0x56c5bf ? _0x5ad387 & 1073741824 ? _0x5ad387 ^ 3221225472 ^ _0x1d88bb ^ _0x1629f5 : _0x5ad387 ^ 1073741824 ^ _0x1d88bb ^ _0x1629f5 : _0x5ad387 ^ _0x1d88bb ^ _0x1629f5;
}
function k(_0x1f8a75, _0x4a3bd3, _0x5a3070, _0x25f36f, _0x4a9473, _0x451bed, _0x437fcb) {
  _0x1f8a75 = h(_0x1f8a75, h(h(_0x4a3bd3 & _0x5a3070 | ~_0x4a3bd3 & _0x25f36f, _0x4a9473), _0x437fcb));
  return h(_0x1f8a75 << _0x451bed | _0x1f8a75 >>> 32 - _0x451bed, _0x4a3bd3);
}
function hoo(_0xc82e03, _0x164dc2) {
  return sakura.SHA256(_0xc82e03);
}
function xo(_0x272163, _0x47ff07) {
  return _0x272163 + _0x47ff07;
}
function xooo(_0xbece56) {
  function _0x50a213(_0x47e4e0) {
    var _0x4a8091 = '',
        _0x32f23e = '',
        _0x1a2975;

    for (_0x1a2975 = 0; 3 >= _0x1a2975; _0x1a2975++) {
      _0x32f23e = _0x47e4e0 >>> 8 * _0x1a2975 & 255;
      _0x32f23e = "0" + _0x32f23e["toString"](16);
      _0x4a8091 += _0x32f23e["substr"](_0x32f23e["length"] - 2, 2);
    }

    return _0x4a8091;
  }

  var _0x1b8333 = [],
      _0x28207d,
      _0x383438,
      _0x11fccf,
      _0x3ce4d1,
      _0x452f67,
      _0x20d302,
      _0x3a8a59,
      _0x58cff2;

  _0xbece56 = function (_0x1a1913) {
    _0x1a1913 = _0x1a1913["replace"](/\\r\\n/g, "\\n");

    for (var _0x34d0f0 = '', _0x52db02 = 0; _0x52db02 < _0x1a1913["length"]; _0x52db02++) {
      var _0x23313b = _0x1a1913["charCodeAt"](_0x52db02);

      128 > _0x23313b ? _0x34d0f0 += String["fromCharCode"](_0x23313b) : (127 < _0x23313b && 2048 > _0x23313b ? _0x34d0f0 += String["fromCharCode"](_0x23313b >> 6 | 192) : (_0x34d0f0 += String["fromCharCode"](_0x23313b >> 12 | 224), _0x34d0f0 += String["fromCharCode"](_0x23313b >> 6 & 63 | 128)), _0x34d0f0 += String["fromCharCode"](_0x23313b & 63 | 128));
    }

    return _0x34d0f0;
  }(_0xbece56);

  _0x1b8333 = function (_0x857796) {
    var _0x1608a4,
        _0x7de62 = _0x857796["length"];

    _0x1608a4 = _0x7de62 + 8;

    for (var _0x1b0bcd = 16 * ((_0x1608a4 - _0x1608a4 % 64) / 64 + 1), _0x26393 = Array(_0x1b0bcd - 1), _0x5e2c4a = 0, _0x5038ff = 0; _0x5038ff < _0x7de62;) {
      _0x1608a4 = (_0x5038ff - _0x5038ff % 4) / 4;
      _0x5e2c4a = _0x5038ff % 4 * 8;
      _0x26393[_0x1608a4] |= _0x857796["charCodeAt"](_0x5038ff) << _0x5e2c4a;
      _0x5038ff++;
    }

    _0x1608a4 = (_0x5038ff - _0x5038ff % 4) / 4;
    _0x26393[_0x1608a4] |= 128 << _0x5038ff % 4 * 8;
    _0x26393[_0x1b0bcd - 2] = _0x7de62 << 3;
    _0x26393[_0x1b0bcd - 1] = _0x7de62 >>> 29;
    return _0x26393;
  }(_0xbece56);

  _0x452f67 = 271733878;
  _0x20d302 = 2562383102;
  _0x3a8a59 = 4023233417;
  _0x58cff2 = 1732584193;

  for (_0xbece56 = 0; _0xbece56 < _0x1b8333["length"]; _0xbece56 += 16) {
    _0x28207d = _0x452f67;
    _0x383438 = _0x20d302;
    _0x11fccf = _0x3a8a59;
    _0x3ce4d1 = _0x58cff2;
    _0x452f67 = k(_0x452f67, _0x20d302, _0x3a8a59, _0x58cff2, _0x1b8333[_0xbece56 + 0], 7, 3614090360);
    _0x58cff2 = k(_0x58cff2, _0x452f67, _0x20d302, _0x3a8a59, _0x1b8333[_0xbece56 + 1], 12, 3905402710);
    _0x3a8a59 = k(_0x3a8a59, _0x58cff2, _0x452f67, _0x20d302, _0x1b8333[_0xbece56 + 2], 17, 606105819);
    _0x20d302 = k(_0x20d302, _0x3a8a59, _0x58cff2, _0x452f67, _0x1b8333[_0xbece56 + 3], 22, 3250441966);
    _0x452f67 = k(_0x452f67, _0x20d302, _0x3a8a59, _0x58cff2, _0x1b8333[_0xbece56 + 4], 7, 4118548399);
    _0x58cff2 = k(_0x58cff2, _0x452f67, _0x20d302, _0x3a8a59, _0x1b8333[_0xbece56 + 5], 12, 1200080426);
    _0x3a8a59 = k(_0x3a8a59, _0x58cff2, _0x452f67, _0x20d302, _0x1b8333[_0xbece56 + 6], 17, 2821735955);
    _0x20d302 = k(_0x20d302, _0x3a8a59, _0x58cff2, _0x452f67, _0x1b8333[_0xbece56 + 7], 22, 4249261313);
    _0x452f67 = k(_0x452f67, _0x20d302, _0x3a8a59, _0x58cff2, _0x1b8333[_0xbece56 + 8], 7, 1770035416);
    _0x58cff2 = k(_0x58cff2, _0x452f67, _0x20d302, _0x3a8a59, _0x1b8333[_0xbece56 + 9], 12, 2336552879);
    _0x3a8a59 = k(_0x3a8a59, _0x58cff2, _0x452f67, _0x20d302, _0x1b8333[_0xbece56 + 10], 17, 4294925233);
    _0x20d302 = k(_0x20d302, _0x3a8a59, _0x58cff2, _0x452f67, _0x1b8333[_0xbece56 + 11], 22, 2304563134);
    _0x452f67 = k(_0x452f67, _0x20d302, _0x3a8a59, _0x58cff2, _0x1b8333[_0xbece56 + 12], 7, 1804603682);
    _0x58cff2 = k(_0x58cff2, _0x452f67, _0x20d302, _0x3a8a59, _0x1b8333[_0xbece56 + 13], 12, 4254626195);
    _0x3a8a59 = k(_0x3a8a59, _0x58cff2, _0x452f67, _0x20d302, _0x1b8333[_0xbece56 + 14], 17, 2792965006);
    _0x20d302 = k(_0x20d302, _0x3a8a59, _0x58cff2, _0x452f67, _0x1b8333[_0xbece56 + 15], 22, 1236535329);
    _0x452f67 = l(_0x452f67, _0x20d302, _0x3a8a59, _0x58cff2, _0x1b8333[_0xbece56 + 1], 5, 4129170786);
    _0x58cff2 = l(_0x58cff2, _0x452f67, _0x20d302, _0x3a8a59, _0x1b8333[_0xbece56 + 6], 9, 3225465664);
    _0x3a8a59 = l(_0x3a8a59, _0x58cff2, _0x452f67, _0x20d302, _0x1b8333[_0xbece56 + 11], 14, 643717713);
    _0x20d302 = l(_0x20d302, _0x3a8a59, _0x58cff2, _0x452f67, _0x1b8333[_0xbece56 + 0], 20, 3921069994);
    _0x452f67 = l(_0x452f67, _0x20d302, _0x3a8a59, _0x58cff2, _0x1b8333[_0xbece56 + 5], 5, 3593408605);
    _0x58cff2 = l(_0x58cff2, _0x452f67, _0x20d302, _0x3a8a59, _0x1b8333[_0xbece56 + 10], 9, 38016083);
    _0x3a8a59 = l(_0x3a8a59, _0x58cff2, _0x452f67, _0x20d302, _0x1b8333[_0xbece56 + 15], 14, 3634488961);
    _0x20d302 = l(_0x20d302, _0x3a8a59, _0x58cff2, _0x452f67, _0x1b8333[_0xbece56 + 4], 20, 3889429448);
    _0x452f67 = l(_0x452f67, _0x20d302, _0x3a8a59, _0x58cff2, _0x1b8333[_0xbece56 + 9], 5, 568446438);
    _0x58cff2 = l(_0x58cff2, _0x452f67, _0x20d302, _0x3a8a59, _0x1b8333[_0xbece56 + 14], 9, 3275163606);
    _0x3a8a59 = l(_0x3a8a59, _0x58cff2, _0x452f67, _0x20d302, _0x1b8333[_0xbece56 + 3], 14, 4107603335);
    _0x20d302 = l(_0x20d302, _0x3a8a59, _0x58cff2, _0x452f67, _0x1b8333[_0xbece56 + 8], 20, 1163531501);
    _0x452f67 = l(_0x452f67, _0x20d302, _0x3a8a59, _0x58cff2, _0x1b8333[_0xbece56 + 13], 5, 2850285829);
    _0x58cff2 = l(_0x58cff2, _0x452f67, _0x20d302, _0x3a8a59, _0x1b8333[_0xbece56 + 2], 9, 4243563512);
    _0x3a8a59 = l(_0x3a8a59, _0x58cff2, _0x452f67, _0x20d302, _0x1b8333[_0xbece56 + 7], 14, 1735328473);
    _0x20d302 = l(_0x20d302, _0x3a8a59, _0x58cff2, _0x452f67, _0x1b8333[_0xbece56 + 12], 20, 2368359562);
    _0x452f67 = m(_0x452f67, _0x20d302, _0x3a8a59, _0x58cff2, _0x1b8333[_0xbece56 + 5], 4, 4294588738);
    _0x58cff2 = m(_0x58cff2, _0x452f67, _0x20d302, _0x3a8a59, _0x1b8333[_0xbece56 + 8], 11, 2272392833);
    _0x3a8a59 = m(_0x3a8a59, _0x58cff2, _0x452f67, _0x20d302, _0x1b8333[_0xbece56 + 11], 16, 1839030562);
    _0x20d302 = m(_0x20d302, _0x3a8a59, _0x58cff2, _0x452f67, _0x1b8333[_0xbece56 + 14], 23, 4259657740);
    _0x452f67 = m(_0x452f67, _0x20d302, _0x3a8a59, _0x58cff2, _0x1b8333[_0xbece56 + 1], 4, 2763975236);
    _0x58cff2 = m(_0x58cff2, _0x452f67, _0x20d302, _0x3a8a59, _0x1b8333[_0xbece56 + 4], 11, 1272893353);
    _0x3a8a59 = m(_0x3a8a59, _0x58cff2, _0x452f67, _0x20d302, _0x1b8333[_0xbece56 + 7], 16, 4139469664);
    _0x20d302 = m(_0x20d302, _0x3a8a59, _0x58cff2, _0x452f67, _0x1b8333[_0xbece56 + 10], 23, 3200236656);
    _0x452f67 = m(_0x452f67, _0x20d302, _0x3a8a59, _0x58cff2, _0x1b8333[_0xbece56 + 13], 4, 681279174);
    _0x58cff2 = m(_0x58cff2, _0x452f67, _0x20d302, _0x3a8a59, _0x1b8333[_0xbece56 + 0], 11, 3936430074);
    _0x3a8a59 = m(_0x3a8a59, _0x58cff2, _0x452f67, _0x20d302, _0x1b8333[_0xbece56 + 3], 16, 3572445317);
    _0x20d302 = m(_0x20d302, _0x3a8a59, _0x58cff2, _0x452f67, _0x1b8333[_0xbece56 + 6], 23, 76029189);
    _0x452f67 = m(_0x452f67, _0x20d302, _0x3a8a59, _0x58cff2, _0x1b8333[_0xbece56 + 9], 4, 3654602809);
    _0x58cff2 = m(_0x58cff2, _0x452f67, _0x20d302, _0x3a8a59, _0x1b8333[_0xbece56 + 12], 11, 3873151461);
    _0x3a8a59 = m(_0x3a8a59, _0x58cff2, _0x452f67, _0x20d302, _0x1b8333[_0xbece56 + 15], 16, 530742520);
    _0x20d302 = m(_0x20d302, _0x3a8a59, _0x58cff2, _0x452f67, _0x1b8333[_0xbece56 + 2], 23, 3299628645);
    _0x452f67 = n(_0x452f67, _0x20d302, _0x3a8a59, _0x58cff2, _0x1b8333[_0xbece56 + 0], 6, 4096336452);
    _0x58cff2 = n(_0x58cff2, _0x452f67, _0x20d302, _0x3a8a59, _0x1b8333[_0xbece56 + 7], 10, 1126891415);
    _0x3a8a59 = n(_0x3a8a59, _0x58cff2, _0x452f67, _0x20d302, _0x1b8333[_0xbece56 + 14], 15, 2878612391);
    _0x20d302 = n(_0x20d302, _0x3a8a59, _0x58cff2, _0x452f67, _0x1b8333[_0xbece56 + 5], 21, 4237533241);
    _0x452f67 = n(_0x452f67, _0x20d302, _0x3a8a59, _0x58cff2, _0x1b8333[_0xbece56 + 12], 6, 1700485571);
    _0x58cff2 = n(_0x58cff2, _0x452f67, _0x20d302, _0x3a8a59, _0x1b8333[_0xbece56 + 3], 10, 2399980690);
    _0x3a8a59 = n(_0x3a8a59, _0x58cff2, _0x452f67, _0x20d302, _0x1b8333[_0xbece56 + 10], 15, 4293915773);
    _0x20d302 = n(_0x20d302, _0x3a8a59, _0x58cff2, _0x452f67, _0x1b8333[_0xbece56 + 1], 21, 2240044497);
    _0x452f67 = n(_0x452f67, _0x20d302, _0x3a8a59, _0x58cff2, _0x1b8333[_0xbece56 + 8], 6, 1873313359);
    _0x58cff2 = n(_0x58cff2, _0x452f67, _0x20d302, _0x3a8a59, _0x1b8333[_0xbece56 + 15], 10, 4264355552);
    _0x3a8a59 = n(_0x3a8a59, _0x58cff2, _0x452f67, _0x20d302, _0x1b8333[_0xbece56 + 6], 15, 2734768916);
    _0x20d302 = n(_0x20d302, _0x3a8a59, _0x58cff2, _0x452f67, _0x1b8333[_0xbece56 + 13], 21, 1309151649);
    _0x452f67 = n(_0x452f67, _0x20d302, _0x3a8a59, _0x58cff2, _0x1b8333[_0xbece56 + 4], 6, 4149444226);
    _0x58cff2 = n(_0x58cff2, _0x452f67, _0x20d302, _0x3a8a59, _0x1b8333[_0xbece56 + 11], 10, 3174756917);
    _0x3a8a59 = n(_0x3a8a59, _0x58cff2, _0x452f67, _0x20d302, _0x1b8333[_0xbece56 + 2], 15, 718787259);
    _0x20d302 = n(_0x20d302, _0x3a8a59, _0x58cff2, _0x452f67, _0x1b8333[_0xbece56 + 9], 21, 3951481745);
    _0x452f67 = h(_0x452f67, _0x28207d);
    _0x20d302 = h(_0x20d302, _0x383438);
    _0x3a8a59 = h(_0x3a8a59, _0x11fccf);
    _0x58cff2 = h(_0x58cff2, _0x3ce4d1);
  }

  return (_0x50a213(_0x452f67) + _0x50a213(_0x20d302) + _0x50a213(_0x3a8a59) + _0x50a213(_0x58cff2))["toLowerCase"]();
}
function xoo(_0x6672e7, _0xba1572) {
  return hoo(_0x6672e7(_0xba1572));
}
function OOXX(_0x1d2b77, _0x414680, _0x3c906f, _0x3dc595, _0xe29e0c) {
  let _0x57722c = [98, 115, 98, 115, 98, 115, 98, 115, 98, 108],
      _0x315d43 = [];

  for (let _0x512ce5 = 0; _0x512ce5 < _0x57722c["length"]; _0x512ce5++) {
    _0x315d43["push"](String["fromCharCode"](_0x57722c[_0x512ce5]));
  }

  return _0x315d43["join"]("|");
}
function OOOO(_0x58d4b1, _0x19e7b0, _0x19c60c, _0x21036e, _0x19a1bf) {
  let _0x418c3c = OOXX();

  return xoo(xooo, xo(_0x58d4b1, _0x418c3c));
}
function Sakura(page){
  let url = '/api/problem-detail/10/data/?page='
  let t = OOOO(url+page).toString();
  return t
  // console.log(t)
}
Sakura(3)

```
```python
import execjs
import requests
headers = {
    "accept": "application/json, text/javascript, */*; q=0.01",
    "accept-language": "zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6",
    "cache-control": "no-cache",
    "pragma": "no-cache",
    "priority": "u=1, i",
    "referer": "https://www.mashangpa.com/problem-detail/10/",
    "sec-ch-ua": "\"Microsoft Edge\";v=\"141\", \"Not?A_Brand\";v=\"8\", \"Chromium\";v=\"141\"",
    "sec-ch-ua-mobile": "?0",
    "sec-ch-ua-platform": "\"Windows\"",
    "sec-fetch-dest": "empty",
    "sec-fetch-mode": "cors",
    "sec-fetch-site": "same-origin",
    "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36 Edg/141.0.0.0",
    "x-requested-with": "XMLHttpRequest"
}
cookies = {
    "sessionid": "28xvqtouyogiovqb2hxbujws2rkkrruz",
    "Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0": "1759652173,1759756180,1759849061,1760169652",
    "HMACCOUNT": "FA452653B0C48E17",
    "Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0": "1760170455"
}
list = []
for page in range(1,21):
    with open('4.js', 'r', encoding='utf-8') as f:
        ctx = execjs.compile(f.read())
        result = ctx.call('Sakura',page)
    url = "https://www.mashangpa.com/api/problem-detail/10/data/"
    params = {
        "page": page,
        "t": result
    }
    response = requests.get(url, headers=headers, cookies=cookies, params=params).json()
    print(response)
    list += response['current_array']
print(sum(list))
```
## 11.wasm小试牛刀
#### 观察后发现请求头内并没有加密。加密位置在负载中有相应的m值与_ts参数，响应中也没有加密。观察loadPage堆栈，发现const g里面有相应的m值，通过断点调试后发发现m值的生成位置就在这，随后开始扣js代码callEncryptFunction对应的window对象为e4ddd62a文件。最后js和python代码如下:
```js

function a() {
    const P = (function() {
      let _js = 6554
        return [_js, 'EFLSjPQVsjReiPMOaFtrmJHiI.DcWUVoRmE.vd7k==', 'bNTQlG', 'ra7cVCkEW41VASo+W7y0vM3cLa', 'mxStoSoW', 'lHKJW5CVWQxcP8koW41iW4BdVa', 'oSoJsbaXhc3cUmkbW63cTha', 'W5zmW49fW4i', 'uamBWP3cP8knESk+bHpcUSogmSoWWQvWW4Hus8kgWQddI8o8ACkCWR49pKeTWPi', 'WRFcSmkcCN8', 'W40cdSkMW4q', 'bqCzwJ8aW4a', 'umkHiLPM', 'DSoZWRVcKCoP', 'c21XfmktdmoD', 'WONcSSkWWQ1ArtLBW7jhWPddUhX0W4lcMX7cJqy+', 'W5ZdUgfpoq', 'seOBW7NcO8oSWQu', 'W6NdPmkQWPBcNq', 'ymkgpuH3'].concat((function() {
            return ['W5pcHHBdRhfSWQtdLCkLbCoXWPZcRa', 'rSoGmCo5WRi', 'Ch8hdG', 'W7ddGw3dGdHlbG', 'xs8ZdL4', 'q3ZdU8o/gq', 'jKBdRmojWQ0', 'W7zuWRBdUHK', 'WPzIW5FdLmoz', 'seeVW4ZcKSkxWP10WOxdU8keW6hdMrvNpmoTnvRcVcrOWOS', 'WPbNW6G/WRJcOmk+nhpdPmoQCLS', 'WOq4ySk0', 'W5RdRmoPmW3dQ8kIddtdGJyy', 'WOCfumkrW6q', 'W4xdGfXrgG', 'qcPCuG', 'WPdcSuS8WRG', 'CcJdImkltCkjcG', 'fqDmC8ov', 'W6uVWPPOW7G'].concat((function() {
                return ['bxq4W4FcT8oaWP3cKG', 'lr0RW5D8W6NcTmkVW4bI', 'W5JdVMVdGmoxgCkPtstcICkVW6ZdPa', 'q8kDwXxdUwtcImkvW6C', 'W67cMCk/WPFdQSkVW5/cH8oplXZdSCkK', 'WPbLjqRcJxOXfN7cHSosvq', 'h8onkCoHW7hdPI/dGKRdRmoSWRj4BXOBW402WRlcPG', 'pab5WPNcJmkeWRrvW5JdNW', 'WPWZn8kzha', 'WRWZn8kzhgq6WO/dUgNdPCkZW47cJHekWOldUeddQmofFaVcNhfLEuPzoCod', 'sSk5mLze', 'WOvoW57dVa', 'W7zYW6PaW5eGW5FcGq', 'fv7dVmooWPm', 'w8k7WRZdImoK', 'W4awWOVcPmklzmkSW7BdKSorECoR', 'yrKmWPW', 'WOVdG0VcTW', 'lwWlj8oU'];
            }()));
        }()));
    }());
    a = function() {
        return P;
    }
    ;
    return a();
}
// 模拟 WebAssembly 模块
const wasmModule = (() => {
  // === 全局变量 ===
  let global0 = 5243920;

  // === 导出函数 ===
  function _initialize() {
    // 空函数（占位）
  }

  function stackAlloc(size) {
    global0 = (global0 - size) & -16;
    return global0;
  }

  function stackRestore(ptr) {
    global0 = ptr;
  }

  function stackSave() {
    return global0;
  }

  function encrypt(a, b) {
    // WebAssembly的整数除法默认向零取整
    return a + Math.trunc(b / 3) + 16358;
  }
  // === 模块导出 ===
  return {
    _initialize,
    stackAlloc,
    stackRestore,
    stackSave,
    encrypt
  };
})();
function b(c, d) {
    const e = a();
    return b = function(f, g) {
        f = f - 0x90;
        let h = e[f];
        if (b['MZrkWY'] === undefined) {
            var i = function(n) {
                const o = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';
                let p = ''
                  , q = '';
                for (let r = 0x0, s, t, u = 0x0; t = n['charAt'](u++); ~t && (s = r % 0x4 ? s * 0x40 + t : t,
                r++ % 0x4) ? p += String['fromCharCode'](0xff & s >> (-0x2 * r & 0x6)) : 0x0) {
                    t = o['indexOf'](t);
                }
                for (let v = 0x0, w = p['length']; v < w; v++) {
                    q += '%' + ('00' + p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);
                }
                return decodeURIComponent(q);
            };
            const m = function(n, o) {
                let p = [], q = 0x0, r, t = '';
                n = i(n);
                let u;
                for (u = 0x0; u < 0x100; u++) {
                    p[u] = u;
                }
                for (u = 0x0; u < 0x100; u++) {
                    q = (q + p[u] + o['charCodeAt'](u % o['length'])) % 0x100,
                    r = p[u],
                    p[u] = p[q],
                    p[q] = r;
                }
                u = 0x0,
                q = 0x0;
                for (let v = 0x0; v < n['length']; v++) {
                    u = (u + 0x1) % 0x100,
                    q = (q + p[u]) % 0x100,
                    r = p[u],
                    p[u] = p[q],
                    p[q] = r,
                    t += String['fromCharCode'](n['charCodeAt'](v) ^ p[(p[u] + p[q]) % 0x100]);
                }
                return t;
            };
            b['ygIwjZ'] = m,
            c = arguments,
            b['MZrkWY'] = !![];
        }
        const j = e[0x0]
          , k = f + j
          , l = c[k];
        return !l ? (b['dcXJGV'] === undefined && (b['dcXJGV'] = !![]),
        h = b['ygIwjZ'](h, g),
        c[k] = h) : h = l,
        h;
    }
    ,
    b(c, d);
}
function callEncryptFunction(c, d) {
  const F = b
      , f = {
    'gDlFk': F(0xb2, '8WDi')
  };
    const g = wasmModule.encrypt(c, d);
    return g
}
function loadPage(c) {
  const O = b
      , d = {
        'iRmDq': function (i, j) {
          return i(j);
        },
        'GQcTJ': function (i, j) {
          return i / j;
        },
        'wUWKM': function (i, j, k) {
          return i(j, k);
        },
        'Saaxu': function (i, j) {
          return i(j);
        }
      },
      e = d['iRmDq'](parseInt, Math["round"](d["GQcTJ"](new Date()["getTime"](), 1000))["toString"]());
  let f = d["wUWKM"](callEncryptFunction, c, e);
  const g = {
    'page': c,
    'm': f,
    '_ts': e
  }
  return g;
}
//loadPage(3)
```
```python
import requests
import execjs
headers = {
    "accept": "*/*",
    "accept-language": "zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6",
    "cache-control": "no-cache",
    "pragma": "no-cache",
    "priority": "u=1, i",
    "referer": "https://www.mashangpa.com/problem-detail/11/",
    "sec-ch-ua": "\"Microsoft Edge\";v=\"141\", \"Not?A_Brand\";v=\"8\", \"Chromium\";v=\"141\"",
    "sec-ch-ua-mobile": "?0",
    "sec-ch-ua-platform": "\"Windows\"",
    "sec-fetch-dest": "empty",
    "sec-fetch-mode": "cors",
    "sec-fetch-site": "same-origin",
    "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36 Edg/141.0.0.0"
}
cookies = {
    "sessionid": "28xvqtouyogiovqb2hxbujws2rkkrruz",
    "Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0": "1759652173,1759756180,1759849061,1760169652",
    "HMACCOUNT": "FA452653B0C48E17",
    "Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0": "1760172118"
}
url = "https://www.mashangpa.com/api/problem-detail/11/data/"
list = []
for page in range(1, 21):
    with open('4.js','r',encoding='utf-8') as f:
        ctx = execjs.compile(f.read())
        params = ctx.call('loadPage',page)
        print(params)

    response = requests.get(url, headers=headers, cookies=cookies, params=params).json()
    current_array = response['current_array']
    list += current_array
    print(response)
print(sum(list))
```
## 12.jsvmp
#### 这个太难了作者本人还不会
```js
// 以后补上
```
```python
# 以后补上
```
## 13.风火轮
#### 本题目为请求头的加密方式r,m加密与ts，观察调用的loadPage发现找不到，看旁边侧边栏的js文件发现有base文件但是点击发现没事用，点击jqueryxhr.js，发现为ob混淆，解混淆观察js代码 最后发现加密位置，于是开始扣js代码 _0x3565b7没啥用就是对请求头替换用的可以直接删掉。
```js
setInterval(() => {
  (function (_0xcd5855) {
    return function (_0x548021) {
      return Function("Function(arguments[0]+\"" + _0x548021 + "\")()");
    }(_0xcd5855);
  })("bugger")("de", 0, 0, (0, 0));
}, 1000);
const originalJSON = {
  "stringify": JSON["stringify"],
  "parse": JSON["parse"]
},
      x1 = new Proxy(originalJSON, {
  "get"(_0x1d3ede, _0xcace7f) {
    if (_0xcace7f === "stringify") {
      return function (..._0x1fdf05) {
        return _0x1d3ede["stringify"](..._0x1fdf05);
      };
    } else {
      if (_0xcace7f === "parse") {
        return function (..._0x45d409) {
          return _0x1d3ede["parse"](..._0x45d409);
        };
      }
    }

    return _0x1d3ede[_0xcace7f];
  }

});

var mmm = function (_0x3d02a0) {
  function _0x1dbdb9(_0x2a6028) {
    if (_0x375c2e[_0x2a6028]) {
      return _0x375c2e[_0x2a6028]["exports"];
    }

    var _0x32d6fc = _0x375c2e[_0x2a6028] = {
      "i": _0x2a6028,
      "l": false,
      "exports": {}
    };

    _0x3d02a0[_0x2a6028]["call"](_0x32d6fc["exports"], _0x32d6fc, _0x32d6fc["exports"], _0x1dbdb9);

    _0x32d6fc["l"] = true;
    return _0x32d6fc["exports"];
  }

  var _0x375c2e = {};
  _0x1dbdb9["m"] = _0x3d02a0;
  _0x1dbdb9["c"] = _0x375c2e;

  _0x1dbdb9["i"] = function (_0x24ef10) {
    return _0x24ef10;
  };

  _0x1dbdb9["d"] = function (_0x27956f, _0x49b080, _0x1278a9) {
    _0x1dbdb9["o"](_0x27956f, _0x49b080) || Object["defineProperty"](_0x27956f, _0x49b080, {
      "configurable": false,
      "enumerable": true,
      "get": _0x1278a9
    });
  };

  _0x1dbdb9["n"] = function (_0x374742) {
    var _0x5da6bd = _0x374742 && _0x374742["__esModule"] ? function () {
      return _0x374742["default"];
    } : function () {
      return _0x374742;
    };

    _0x1dbdb9["d"](_0x5da6bd, "a", _0x5da6bd);

    return _0x5da6bd;
  };

  _0x1dbdb9["o"] = function (_0x1a3a4f, _0x4ac58f) {
    return Object["prototype"]["hasOwnProperty"]["call"](_0x1a3a4f, _0x4ac58f);
  };

  _0x1dbdb9["p"] = '';
  return _0x1dbdb9(_0x1dbdb9["s"] = 4);
}([function (_0x5e5c2a, _0x2e9f47) {
  var _0x46e5e1 = {
    "utf8": {
      "stringToBytes": function (_0x15daf1) {
        return _0x46e5e1["bin"]["stringToBytes"](unescape(encodeURIComponent(_0x15daf1)));
      },
      "bytesToString": function (_0x51b8ea) {
        return decodeURIComponent(escape(_0x46e5e1["bin"]["bytesToString"](_0x51b8ea)));
      }
    },
    "bin": {
      "stringToBytes": function (_0xbb4fdc) {
        for (var _0x27f4b5 = [], _0x368fe0 = 0; _0x368fe0 < _0xbb4fdc["length"]; _0x368fe0++) {
          _0x27f4b5["push"](255 & _0xbb4fdc["charCodeAt"](_0x368fe0));
        }

        return _0x27f4b5;
      },
      "bytesToString": function (_0x488932) {
        for (var _0x4a4c41 = [], _0x3b39b4 = 0; _0x3b39b4 < _0x488932["length"]; _0x3b39b4++) {
          _0x4a4c41["push"](String["fromCharCode"](_0x488932[_0x3b39b4]));
        }

        return _0x4a4c41["join"]('');
      }
    }
  };
  _0x5e5c2a["exports"] = _0x46e5e1;
}, function (_0x43b475, _0x568be1, _0x424828) {
  !function () {
    var _0x10d93f = _0x424828(2),
        _0x59a113 = _0x424828(0)["utf8"],
        _0x2e85b1 = _0x424828(3),
        _0x5a292a = _0x424828(0)["bin"],
        _0x202411 = function (_0x26d53b, _0x40dd99) {
      _0x26d53b["constructor"] == String ? _0x26d53b = _0x40dd99 && "binary" === _0x40dd99["encoding"] ? _0x5a292a["stringToBytes"](_0x26d53b) : _0x59a113["stringToBytes"](_0x26d53b) : _0x2e85b1(_0x26d53b) ? _0x26d53b = Array["prototype"]["slice"]["call"](_0x26d53b, 0) : Array["isArray"](_0x26d53b) || (_0x26d53b = _0x26d53b["toString"]());

      for (var _0x3c00c8 = _0x10d93f["bytesToWords"](_0x26d53b), _0x4b6cc4 = 8 * _0x26d53b["length"], _0x251a7f = 1732584193, _0xa16a85 = -271733879, _0x413855 = -1732584194, _0xb58270 = 271733878, _0x1cebcd = 0; _0x1cebcd < _0x3c00c8["length"]; _0x1cebcd++) {
        _0x3c00c8[_0x1cebcd] = 16711935 & (_0x3c00c8[_0x1cebcd] << 8 | _0x3c00c8[_0x1cebcd] >>> 24) | 4278255360 & (_0x3c00c8[_0x1cebcd] << 24 | _0x3c00c8[_0x1cebcd] >>> 8);
      }

      _0x3c00c8[_0x4b6cc4 >>> 5] |= 128 << _0x4b6cc4 % 32;
      _0x3c00c8[14 + (_0x4b6cc4 + 64 >>> 9 << 4)] = _0x4b6cc4;

      for (var _0x395525 = _0x202411["_ff"], _0x5706b9 = _0x202411["_gg"], _0x43bc50 = _0x202411["_hh"], _0x322883 = _0x202411["_ii"], _0x1cebcd = 0; _0x1cebcd < _0x3c00c8["length"]; _0x1cebcd += 16) {
        var _0x252e0b = _0x251a7f,
            _0xacf563 = _0xa16a85,
            _0x28faaf = _0x413855,
            _0x16180c = _0xb58270;
        _0x251a7f = _0x395525(_0x251a7f, _0xa16a85, _0x413855, _0xb58270, _0x3c00c8[_0x1cebcd + 0], 7, -680876936);
        _0xb58270 = _0x395525(_0xb58270, _0x251a7f, _0xa16a85, _0x413855, _0x3c00c8[_0x1cebcd + 1], 12, -389564586);
        _0x413855 = _0x395525(_0x413855, _0xb58270, _0x251a7f, _0xa16a85, _0x3c00c8[_0x1cebcd + 2], 17, 606105819);
        _0xa16a85 = _0x395525(_0xa16a85, _0x413855, _0xb58270, _0x251a7f, _0x3c00c8[_0x1cebcd + 3], 22, -1044525330);
        _0x251a7f = _0x395525(_0x251a7f, _0xa16a85, _0x413855, _0xb58270, _0x3c00c8[_0x1cebcd + 4], 7, -176418897);
        _0xb58270 = _0x395525(_0xb58270, _0x251a7f, _0xa16a85, _0x413855, _0x3c00c8[_0x1cebcd + 5], 12, 1200080426);
        _0x413855 = _0x395525(_0x413855, _0xb58270, _0x251a7f, _0xa16a85, _0x3c00c8[_0x1cebcd + 6], 17, -1473231341);
        _0xa16a85 = _0x395525(_0xa16a85, _0x413855, _0xb58270, _0x251a7f, _0x3c00c8[_0x1cebcd + 7], 22, -45705983);
        _0x251a7f = _0x395525(_0x251a7f, _0xa16a85, _0x413855, _0xb58270, _0x3c00c8[_0x1cebcd + 8], 7, 1770035416);
        _0xb58270 = _0x395525(_0xb58270, _0x251a7f, _0xa16a85, _0x413855, _0x3c00c8[_0x1cebcd + 9], 12, -1958414417);
        _0x413855 = _0x395525(_0x413855, _0xb58270, _0x251a7f, _0xa16a85, _0x3c00c8[_0x1cebcd + 10], 17, -42063);
        _0xa16a85 = _0x395525(_0xa16a85, _0x413855, _0xb58270, _0x251a7f, _0x3c00c8[_0x1cebcd + 11], 22, -1990404162);
        _0x251a7f = _0x395525(_0x251a7f, _0xa16a85, _0x413855, _0xb58270, _0x3c00c8[_0x1cebcd + 12], 7, 1804603682);
        _0xb58270 = _0x395525(_0xb58270, _0x251a7f, _0xa16a85, _0x413855, _0x3c00c8[_0x1cebcd + 13], 12, -40341101);
        _0x413855 = _0x395525(_0x413855, _0xb58270, _0x251a7f, _0xa16a85, _0x3c00c8[_0x1cebcd + 14], 17, -1502002290);
        _0xa16a85 = _0x395525(_0xa16a85, _0x413855, _0xb58270, _0x251a7f, _0x3c00c8[_0x1cebcd + 15], 22, 1236535329);
        _0x251a7f = _0x5706b9(_0x251a7f, _0xa16a85, _0x413855, _0xb58270, _0x3c00c8[_0x1cebcd + 1], 5, -165796510);
        _0xb58270 = _0x5706b9(_0xb58270, _0x251a7f, _0xa16a85, _0x413855, _0x3c00c8[_0x1cebcd + 6], 9, -1069501632);
        _0x413855 = _0x5706b9(_0x413855, _0xb58270, _0x251a7f, _0xa16a85, _0x3c00c8[_0x1cebcd + 11], 14, 643717713);
        _0xa16a85 = _0x5706b9(_0xa16a85, _0x413855, _0xb58270, _0x251a7f, _0x3c00c8[_0x1cebcd + 0], 20, -373897302);
        _0x251a7f = _0x5706b9(_0x251a7f, _0xa16a85, _0x413855, _0xb58270, _0x3c00c8[_0x1cebcd + 5], 5, -701558691);
        _0xb58270 = _0x5706b9(_0xb58270, _0x251a7f, _0xa16a85, _0x413855, _0x3c00c8[_0x1cebcd + 10], 9, 38016083);
        _0x413855 = _0x5706b9(_0x413855, _0xb58270, _0x251a7f, _0xa16a85, _0x3c00c8[_0x1cebcd + 15], 14, -660478335);
        _0xa16a85 = _0x5706b9(_0xa16a85, _0x413855, _0xb58270, _0x251a7f, _0x3c00c8[_0x1cebcd + 4], 20, -405537848);
        _0x251a7f = _0x5706b9(_0x251a7f, _0xa16a85, _0x413855, _0xb58270, _0x3c00c8[_0x1cebcd + 9], 5, 568446438);
        _0xb58270 = _0x5706b9(_0xb58270, _0x251a7f, _0xa16a85, _0x413855, _0x3c00c8[_0x1cebcd + 14], 9, -1019803690);
        _0x413855 = _0x5706b9(_0x413855, _0xb58270, _0x251a7f, _0xa16a85, _0x3c00c8[_0x1cebcd + 3], 14, -187363961);
        _0xa16a85 = _0x5706b9(_0xa16a85, _0x413855, _0xb58270, _0x251a7f, _0x3c00c8[_0x1cebcd + 8], 20, 1163531501);
        _0x251a7f = _0x5706b9(_0x251a7f, _0xa16a85, _0x413855, _0xb58270, _0x3c00c8[_0x1cebcd + 13], 5, -1444681467);
        _0xb58270 = _0x5706b9(_0xb58270, _0x251a7f, _0xa16a85, _0x413855, _0x3c00c8[_0x1cebcd + 2], 9, -51403784);
        _0x413855 = _0x5706b9(_0x413855, _0xb58270, _0x251a7f, _0xa16a85, _0x3c00c8[_0x1cebcd + 7], 14, 1735328473);
        _0xa16a85 = _0x5706b9(_0xa16a85, _0x413855, _0xb58270, _0x251a7f, _0x3c00c8[_0x1cebcd + 12], 20, -1926607734);
        _0x251a7f = _0x43bc50(_0x251a7f, _0xa16a85, _0x413855, _0xb58270, _0x3c00c8[_0x1cebcd + 5], 4, -378558);
        _0xb58270 = _0x43bc50(_0xb58270, _0x251a7f, _0xa16a85, _0x413855, _0x3c00c8[_0x1cebcd + 8], 11, -2022574463);
        _0x413855 = _0x43bc50(_0x413855, _0xb58270, _0x251a7f, _0xa16a85, _0x3c00c8[_0x1cebcd + 11], 16, 1839030562);
        _0xa16a85 = _0x43bc50(_0xa16a85, _0x413855, _0xb58270, _0x251a7f, _0x3c00c8[_0x1cebcd + 14], 23, -35309556);
        _0x251a7f = _0x43bc50(_0x251a7f, _0xa16a85, _0x413855, _0xb58270, _0x3c00c8[_0x1cebcd + 1], 4, -1530992060);
        _0xb58270 = _0x43bc50(_0xb58270, _0x251a7f, _0xa16a85, _0x413855, _0x3c00c8[_0x1cebcd + 4], 11, 1272893353);
        _0x413855 = _0x43bc50(_0x413855, _0xb58270, _0x251a7f, _0xa16a85, _0x3c00c8[_0x1cebcd + 7], 16, -155497632);
        _0xa16a85 = _0x43bc50(_0xa16a85, _0x413855, _0xb58270, _0x251a7f, _0x3c00c8[_0x1cebcd + 10], 23, -1094730640);
        _0x251a7f = _0x43bc50(_0x251a7f, _0xa16a85, _0x413855, _0xb58270, _0x3c00c8[_0x1cebcd + 13], 4, 681279174);
        _0xb58270 = _0x43bc50(_0xb58270, _0x251a7f, _0xa16a85, _0x413855, _0x3c00c8[_0x1cebcd + 0], 11, -358537222);
        _0x413855 = _0x43bc50(_0x413855, _0xb58270, _0x251a7f, _0xa16a85, _0x3c00c8[_0x1cebcd + 3], 16, -722521979);
        _0xa16a85 = _0x43bc50(_0xa16a85, _0x413855, _0xb58270, _0x251a7f, _0x3c00c8[_0x1cebcd + 6], 23, 76029189);
        _0x251a7f = _0x43bc50(_0x251a7f, _0xa16a85, _0x413855, _0xb58270, _0x3c00c8[_0x1cebcd + 9], 4, -640364487);
        _0xb58270 = _0x43bc50(_0xb58270, _0x251a7f, _0xa16a85, _0x413855, _0x3c00c8[_0x1cebcd + 12], 11, -421815835);
        _0x413855 = _0x43bc50(_0x413855, _0xb58270, _0x251a7f, _0xa16a85, _0x3c00c8[_0x1cebcd + 15], 16, 530742520);
        _0xa16a85 = _0x43bc50(_0xa16a85, _0x413855, _0xb58270, _0x251a7f, _0x3c00c8[_0x1cebcd + 2], 23, -995338651);
        _0x251a7f = _0x322883(_0x251a7f, _0xa16a85, _0x413855, _0xb58270, _0x3c00c8[_0x1cebcd + 0], 6, -198630844);
        _0xb58270 = _0x322883(_0xb58270, _0x251a7f, _0xa16a85, _0x413855, _0x3c00c8[_0x1cebcd + 7], 10, 1126891415);
        _0x413855 = _0x322883(_0x413855, _0xb58270, _0x251a7f, _0xa16a85, _0x3c00c8[_0x1cebcd + 14], 15, -1416354905);
        _0xa16a85 = _0x322883(_0xa16a85, _0x413855, _0xb58270, _0x251a7f, _0x3c00c8[_0x1cebcd + 5], 21, -57434055);
        _0x251a7f = _0x322883(_0x251a7f, _0xa16a85, _0x413855, _0xb58270, _0x3c00c8[_0x1cebcd + 12], 6, 1700485571);
        _0xb58270 = _0x322883(_0xb58270, _0x251a7f, _0xa16a85, _0x413855, _0x3c00c8[_0x1cebcd + 3], 10, -1894986606);
        _0x413855 = _0x322883(_0x413855, _0xb58270, _0x251a7f, _0xa16a85, _0x3c00c8[_0x1cebcd + 10], 15, -1051523);
        _0xa16a85 = _0x322883(_0xa16a85, _0x413855, _0xb58270, _0x251a7f, _0x3c00c8[_0x1cebcd + 1], 21, -2054922799);
        _0x251a7f = _0x322883(_0x251a7f, _0xa16a85, _0x413855, _0xb58270, _0x3c00c8[_0x1cebcd + 8], 6, 1873313359);
        _0xb58270 = _0x322883(_0xb58270, _0x251a7f, _0xa16a85, _0x413855, _0x3c00c8[_0x1cebcd + 15], 10, -30611744);
        _0x413855 = _0x322883(_0x413855, _0xb58270, _0x251a7f, _0xa16a85, _0x3c00c8[_0x1cebcd + 6], 15, -1560198380);
        _0xa16a85 = _0x322883(_0xa16a85, _0x413855, _0xb58270, _0x251a7f, _0x3c00c8[_0x1cebcd + 13], 21, 1309151649);
        _0x251a7f = _0x322883(_0x251a7f, _0xa16a85, _0x413855, _0xb58270, _0x3c00c8[_0x1cebcd + 4], 6, -145523070);
        _0xb58270 = _0x322883(_0xb58270, _0x251a7f, _0xa16a85, _0x413855, _0x3c00c8[_0x1cebcd + 11], 10, -1120210379);
        _0x413855 = _0x322883(_0x413855, _0xb58270, _0x251a7f, _0xa16a85, _0x3c00c8[_0x1cebcd + 2], 15, 718787259);
        _0xa16a85 = _0x322883(_0xa16a85, _0x413855, _0xb58270, _0x251a7f, _0x3c00c8[_0x1cebcd + 9], 21, -343485551);
        _0x251a7f = _0x251a7f + _0x252e0b >>> 0;
        _0xa16a85 = _0xa16a85 + _0xacf563 >>> 0;
        _0x413855 = _0x413855 + _0x28faaf >>> 0;
        _0xb58270 = _0xb58270 + _0x16180c >>> 0;
      }

      return _0x10d93f["endian"]([_0x251a7f, _0xa16a85, _0x413855, _0xb58270]);
    };

    _0x202411["_ff"] = function (_0x39ccbe, _0x7dcee4, _0x2d1c0d, _0x208e16, _0x48cc7b, _0x10eea0, _0x1b42ef) {
      var _0x5d1954 = _0x39ccbe + (_0x7dcee4 & _0x2d1c0d | ~_0x7dcee4 & _0x208e16) + (_0x48cc7b >>> 0) + _0x1b42ef;

      return (_0x5d1954 << _0x10eea0 | _0x5d1954 >>> 32 - _0x10eea0) + _0x7dcee4;
    };

    _0x202411["_gg"] = function (_0x3a0f95, _0xb4f9cc, _0x1bc7ea, _0x2f9a1f, _0x6109f, _0x5a4075, _0x1c5742) {
      var _0x2cac31 = _0x3a0f95 + (_0xb4f9cc & _0x2f9a1f | _0x1bc7ea & ~_0x2f9a1f) + (_0x6109f >>> 0) + _0x1c5742;

      return (_0x2cac31 << _0x5a4075 | _0x2cac31 >>> 32 - _0x5a4075) + _0xb4f9cc;
    };

    _0x202411["_hh"] = function (_0x5d9dae, _0x5a66b5, _0x167cb2, _0x434b1b, _0x2cae6c, _0xce09a9, _0x12da9c) {
      var _0x4c7e4e = _0x5d9dae + (_0x5a66b5 ^ _0x167cb2 ^ _0x434b1b) + (_0x2cae6c >>> 0) + _0x12da9c;

      return (_0x4c7e4e << _0xce09a9 | _0x4c7e4e >>> 32 - _0xce09a9) + _0x5a66b5;
    };

    _0x202411["_ii"] = function (_0x56d426, _0x5c57da, _0x59666b, _0xc4df11, _0x50f86d, _0x1438dd, _0x165172) {
      var _0x1cf89a = _0x56d426 + (_0x59666b ^ (_0x5c57da | ~_0xc4df11)) + (_0x50f86d >>> 0) + _0x165172;

      return (_0x1cf89a << _0x1438dd | _0x1cf89a >>> 32 - _0x1438dd) + _0x5c57da;
    };

    _0x202411["_blocksize"] = 16;
    _0x202411["_digestsize"] = 16;

    _0x43b475["exports"] = function (_0x472566, _0x4f1898) {
      if (void 0 === _0x472566 || null === _0x472566) {
        throw new Error("Illegal argument " + _0x472566);
      }

      var _0x84db5 = _0x10d93f["wordsToBytes"](_0x202411(_0x472566, _0x4f1898));

      return _0x4f1898 && _0x4f1898["asBytes"] ? _0x84db5 : _0x4f1898 && _0x4f1898["asString"] ? _0x5a292a["bytesToString"](_0x84db5) : _0x10d93f["bytesToHex"](_0x84db5);
    };
  }();
}, function (_0x29cd0a, _0x5848ca) {
  !function () {
    var _0xa5fc75 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",
        _0xb35a1 = {
      "rotl": function (_0x27f53d, _0x342d11) {
        return _0x27f53d << _0x342d11 | _0x27f53d >>> 32 - _0x342d11;
      },
      "rotr": function (_0x2aa69f, _0x22dae7) {
        return _0x2aa69f << 32 - _0x22dae7 | _0x2aa69f >>> _0x22dae7;
      },
      "endian": function (_0x3bad71) {
        if (_0x3bad71["constructor"] == Number) {
          return 16711935 & _0xb35a1["rotl"](_0x3bad71, 8) | 4278255360 & _0xb35a1["rotl"](_0x3bad71, 24);
        }

        for (var _0x1e5f02 = 0; _0x1e5f02 < _0x3bad71["length"]; _0x1e5f02++) {
          _0x3bad71[_0x1e5f02] = _0xb35a1["endian"](_0x3bad71[_0x1e5f02]);
        }

        return _0x3bad71;
      },
      "randomBytes": function (_0x444f0b) {
        for (var _0x5b2980 = []; _0x444f0b > 0; _0x444f0b--) {
          _0x5b2980["push"](Math["floor"](256 * Math["random"]()));
        }

        return _0x5b2980;
      },
      "bytesToWords": function (_0x269366) {
        for (var _0x10d887 = [], _0x2b1de3 = 0, _0x64fb45 = 0; _0x2b1de3 < _0x269366["length"]; _0x2b1de3++, _0x64fb45 += 8) {
          _0x10d887[_0x64fb45 >>> 5] |= _0x269366[_0x2b1de3] << 24 - _0x64fb45 % 32;
        }

        return _0x10d887;
      },
      "wordsToBytes": function (_0x326eb9) {
        for (var _0x860dbc = [], _0x19f72a = 0; _0x19f72a < 32 * _0x326eb9["length"]; _0x19f72a += 8) {
          _0x860dbc["push"](_0x326eb9[_0x19f72a >>> 5] >>> 24 - _0x19f72a % 32 & 255);
        }

        return _0x860dbc;
      },
      "bytesToHex": function (_0x51f6c1) {
        for (var _0x77badb = [], _0xc67024 = 0; _0xc67024 < _0x51f6c1["length"]; _0xc67024++) {
          _0x77badb["push"]((_0x51f6c1[_0xc67024] >>> 4)["toString"](16));

          _0x77badb["push"]((15 & _0x51f6c1[_0xc67024])["toString"](16));
        }

        return _0x77badb["join"]('');
      },
      "hexToBytes": function (_0x54861c) {
        for (var _0x4504e3 = [], _0x2514de = 0; _0x2514de < _0x54861c["length"]; _0x2514de += 2) {
          _0x4504e3["push"](parseInt(_0x54861c["substr"](_0x2514de, 2), 16));
        }

        return _0x4504e3;
      },
      "bytesToBase64": function (_0x5a750a) {
        for (var _0x3368be = [], _0x2e4b23 = 0; _0x2e4b23 < _0x5a750a["length"]; _0x2e4b23 += 3) {
          for (var _0x41e51a = _0x5a750a[_0x2e4b23] << 16 | _0x5a750a[_0x2e4b23 + 1] << 8 | _0x5a750a[_0x2e4b23 + 2], _0x329b65 = 0; _0x329b65 < 4; _0x329b65++) {
            8 * _0x2e4b23 + 6 * _0x329b65 <= 8 * _0x5a750a["length"] ? _0x3368be["push"](_0xa5fc75["charAt"](_0x41e51a >>> 6 * (3 - _0x329b65) & 63)) : _0x3368be["push"]("=");
          }
        }

        return _0x3368be["join"]('');
      },
      "base64ToBytes": function (_0x241683) {
        _0x241683 = _0x241683["replace"](/[^A-Z0-9+\/]/gi, '');

        for (var _0x43f52f = [], _0x435084 = 0, _0x3c668c = 0; _0x435084 < _0x241683["length"]; _0x3c668c = ++_0x435084 % 4) {
          0 != _0x3c668c && _0x43f52f["push"]((_0xa5fc75["indexOf"](_0x241683["charAt"](_0x435084 - 1)) & Math["pow"](2, -2 * _0x3c668c + 8) - 1) << 2 * _0x3c668c | _0xa5fc75["indexOf"](_0x241683["charAt"](_0x435084)) >>> 6 - 2 * _0x3c668c);
        }

        return _0x43f52f;
      }
    };
    _0x29cd0a["exports"] = _0xb35a1;
  }();
}, function (_0x23e29b, _0x164906) {
  function _0x47256a(_0x4dab9c) {
    return !!_0x4dab9c["constructor"] && "function" == typeof _0x4dab9c["constructor"]["isBuffer"] && _0x4dab9c["constructor"]["isBuffer"](_0x4dab9c);
  }

  function _0x30c836(_0x140a6f) {
    return "function" == typeof _0x140a6f["readFloatLE"] && "function" == typeof _0x140a6f["slice"] && _0x47256a(_0x140a6f["slice"](0, 0));
  }

  _0x23e29b["exports"] = function (_0x57568a) {
    return null != _0x57568a && (_0x47256a(_0x57568a) || _0x30c836(_0x57568a) || !!_0x57568a["_isBuffer"]);
  };
}, function (_0x28a94d, _0x24d55d, _0x2037bf) {
  _0x28a94d["exports"] = _0x2037bf(1);
}]);

(function (_0x48d404, _0x1e61ca) {
  if (typeof exports === "object" && typeof module !== "undefined") {
    module["exports"] = _0x1e61ca();
  } else {
    typeof define === "function" && define["amd"] ? define(_0x1e61ca) : _0x48d404["API"] = _0x1e61ca();
  }
})(this, function () {
  function _0x1e5c29() {
    var _0xee3b28 = [];
    var _0x454710 = "0123456789abcdef";

    for (var _0x20183e = 0; _0x20183e < 32; _0x20183e++) {
      _0xee3b28[_0x20183e] = _0x454710["substr"](Math["floor"](Math["random"]() * 16), 1);
    }

    _0xee3b28[14] = "4";
    _0xee3b28[19] = _0x454710["substr"](_0xee3b28[19] & 3 | 8, 1);
    _0xee3b28[8] = _0xee3b28[13] = _0xee3b28[18] = _0xee3b28[23];

    var _0x4b1861 = _0xee3b28["join"]('');

    return _0x4b1861;
  }

  function _0x321804(_0x16e6dd) {
    var _0xe41c9a = new Array();

    var _0x5c0de1 = 0;

    for (var _0x710b23 in _0x16e6dd) {
      _0xe41c9a[_0x5c0de1] = _0x710b23;
      _0x5c0de1++;
    }

    var _0x5cb7f4 = _0xe41c9a["sort"]();

    var _0xef2cfa = {};

    for (var _0x710b23 in _0x5cb7f4) {
      _0xef2cfa[_0x5cb7f4[_0x710b23]] = _0x16e6dd[_0x5cb7f4[_0x710b23]];
    }

    return _0xef2cfa;
  }

  function _0x10b283(_0x509319) {
    var _0xacbd09 = [],
        _0x38ad9e = {};
    _0xacbd09 = _0x509319["split"]("&");

    for (var _0x2f970b = 0; _0x2f970b < _0xacbd09["length"]; _0x2f970b++) {
      if (_0xacbd09[_0x2f970b]["indexOf"]("=") != -1) {
        var _0x1f7ea4 = _0xacbd09[_0x2f970b]["split"]("=");

        if (_0x1f7ea4["length"] == 2) {
          _0x38ad9e[_0x1f7ea4[0]] = _0x1f7ea4[1];
        } else {
          _0x38ad9e[_0x1f7ea4[0]] = '';
        }
      } else {
        _0x38ad9e[_0xacbd09[_0x2f970b]] = '';
      }
    }

    return _0x38ad9e;
  }

  var _0x3a4216 = $["ajaxSettings"]["beforeSend"];

  $["ajaxSettings"]["beforeSend"] = function (_0x3565b7, _0x891154) {
    var _0x2059bf = Date["parse"](new Date());

    var _0x350b3a = _0x1e5c29();

    var _0x3f9dab = x1["stringify"](_0x321804(_0x10b283(_0x891154["data"] || "{}")));

    var _0x3104de = mmm(_0x3f9dab + _0x350b3a + _0x2059bf);

    _0x891154["data"] = _0x3f9dab;

    _0x3565b7["setRequestHeader"]("t", _0x2059bf);

    _0x3565b7["setRequestHeader"]("r", _0x350b3a);

    _0x3565b7["setRequestHeader"]("s", _0x3104de);

    if (_0x3a4216) {
      return _0x3a4216(jqXHR, _0x891154);
    }
  };
});
```
```python
import execjs
import requests
import json
cookies = {
    "sessionid": "28xvqtouyogiovqb2hxbujws2rkkrruz",
    "Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0": "1759652173,1759756180,1759849061,1760169652",
    "HMACCOUNT": "FA452653B0C48E17",
    "Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0": "1760178485"
}
url = "https://www.mashangpa.com/api/problem-detail/13/data/"
list = []
for page in range(1, 21):
    with open('4.js','r',encoding='utf-8') as f:
        ctx = execjs.compile(f.read())
        result = ctx.call('sakura',page)
    data = {
        "page": str(page),
    }
    headers = {
        "r": result['r'],
        "referer": "https://www.mashangpa.com/problem-detail/13/",
        "s": result['s'],
        "t": result['t'],
        "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36 Edg/141.0.0.0",
        "x-requested-with": "XMLHttpRequest"
    }
    data = json.dumps(data, separators=(',', ':'))
    response = requests.post(url, headers=headers, cookies=cookies, data=data).json()
    list += response['current_array']
    print(response)
print(sum(list))
```
