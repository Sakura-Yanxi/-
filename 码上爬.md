# 码上爬爬虫刷题平台
## 1.动态数据采集
#### 题目很简单，只需要拼接页码参数就可以，防盗链都可以不加
```python
import requests

url = 'https://www.mashangpa.com/api/problem-detail/1/data/?page={}'

headers = {
    'user-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36 Edg/138.0.0.0',
    'cookie':'Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0=1754540935,1754553617; HMACCOUNT=FA452653B0C48E17; sessionid=4ggoy1g3gv9afiw75ikg54aimt7r8xv5; Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0=1754553655',
    'referer':'https://www.mashangpa.com/',
}

list = []
for i in range(1,21):
    r = requests.get(url.format(i), headers=headers).json()
    list += r['current_array']
print(list)
print(sum(list))
```
## 2.headers请求头验证
#### 题目很简单，只需要加入防盗链等，拼接页码参数就可以
```python
import requests
url = 'https://www.mashangpa.com/api/problem-detail/2/data/?'
list = []
headers = {
    'cookie':'Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0=1754540935,1754553617; HMACCOUNT=FA452653B0C48E17; sessionid=4ggoy1g3gv9afiw75ikg54aimt7r8xv5; Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0=1754554890',
    'referer':'https://www.mashangpa.com/problem-detail/2/',
    'user-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36 Edg/138.0.0.0'
}
for i in range(1,21):
    params = {
        'page': i
    }
    response = requests.get(url, headers=headers,params=params).json()
    list += response['current_array']
print(list)
print(sum(list))
```
## 3.浏览器调试
#### 题目有反扒机制可以通过把浏览器弹窗弹出，或者直接进行本地文件的替换。抓到包之后爬取数据就很简单了。
```python
import requests
url = 'https://www.mashangpa.com/api/problem-detail/3/data/?'

list = []
headers = {
    'cookie':'Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0=1754540935,1754553617; HMACCOUNT=FA452653B0C48E17; sessionid=4ggoy1g3gv9afiw75ikg54aimt7r8xv5; Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0=1754554890',
    'referer':'https://www.mashangpa.com/problem-detail/2/',
    'user-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36 Edg/138.0.0.0'
}
for i in range(1,21):
    params = {
        'page': i
    }
    response = requests.get(url, headers=headers,params=params).json()
    list += response['current_array']
print(list)
print(sum(list))
```
## 4.js逆向入门
#### 经过对请求头的观察发现并没有加密，负载中请求参数中有sign和ts的加密，检查调用的堆栈中的loadPage，很容易就发现是md5加密。在控制台中进行检验是否为正常的md5，最后发现为正常的md5加密。最后可以通过python里面的hashlib进行还原。
```python
import hashlib
import requests
import time

url = 'https://www.mashangpa.com/api/problem-detail/4/data/'
headers = {
    'user-agent':'/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36 Edg/138.0.0.0',
    'referer':'https://www.mashangpa.com/problem-detail/4/',
    'cookie':'sessionid=4ggoy1g3gv9afiw75ikg54aimt7r8xv5; Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0=1754557068,1754557358,1754557402,1754557770; HMACCOUNT=FA452653B0C48E17; Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0=1754557772'
}
list = []
def get_sign(page,_ts):
    string = "tuling" + _ts + str(page)
    sign = hashlib.md5(string.encode('utf-8')).hexdigest()
    return sign
for i in range(1,21):
    _ts = str(int(time.time()) * 1000)
    sign = get_sign(i,_ts)
    params = {
        'page':i,
        'sign':sign,
        '_ts':_ts
    }
    resp = requests.get(url,params=params,headers=headers).json()
    current_array = resp['current_array']
    list +=current_array
print(list)
print(sum(list))
```
## 5.屠龙刀
####  经过对请求头的观察发现并没有加密，负载中请求参数中有xl的加密检查调用的堆栈中的loadPage，很容易就发现是AES加密。
```js
const CryptoJS = require('crypto-js')
const _0x38addf = _0x66a7
function _0x66a7(_0x7461a9, _0x14ffcc) {
    const _0x4f0d09 = _0x4f0d();
    return _0x66a7 = function (_0x66a780, _0x2abc15) {
        _0x66a780 = _0x66a780 - 0xc5;
        let _0x477d8f = _0x4f0d09[_0x66a780];
        return _0x477d8f;
    }, _0x66a7(_0x7461a9, _0x14ffcc);
}
function _0x4f0d() {
    const _0x341c37 = ['2440720SaQcQw', 'jo8j9wGw%6HbxfFn', '9735516pjwmiO', '68862pbatqQ', 'mode', 'AES', '1923264HnviQd', '36906bPsIrd', '12hEJHOd', 'enc', 'pad', 'encrypt', 'Hex', 'Utf8', '689460JbShaf', 'parse', '957060HmuxSn', 'toString', '445UZKyxv'];
    _0x4f0d = function () {
        return _0x341c37;
    };
    return _0x4f0d();
}
let key = CryptoJS.enc.Utf8.parse("jo8j9wGw%6HbxfFn"),
    iv = CryptoJS.enc.Utf8.parse('0123456789ABCDEF');

function encrypt(_0x277028) {
    const _0x4d843e = _0x38addf;
    const jsonStr = JSON.stringify(_0x277028, null, 0).replace(/\s+/g, '')
    let _0x2703a2 = CryptoJS.enc.Utf8.parse(jsonStr),
        _0x50fcf0 = CryptoJS.AES.encrypt(_0x2703a2, key, {
            'mode': CryptoJS.mode.CBC,
            'padding': CryptoJS.pad.Pkcs7,
            'iv': iv
        });
    return(_0x50fcf0['ciphertext']["toString"](CryptoJS.enc.Hex))
    // console.log(_0x50fcf0['ciphertext']["toString"](CryptoJS.enc.Hex)) ;
}
// encrypt({"page":2,"_ts":1759588122496})
```
```python
import execjs
import requests
import json
import time

headers = {
    "origin": "https://www.mashangpa.com",
    "priority": "u=1, i",
    "referer": "https://www.mashangpa.com/problem-detail/5/",
    "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36 Edg/141.0.0.0"
}
with open('1.js','r',encoding='utf-8') as f:
    ctx = execjs.compile(f.read())
cookies = {
    "sessionid": "28xvqtouyogiovqb2hxbujws2rkkrruz",
    "Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0": "1758285094,1758635100,1758681400,1759586129",
    "HMACCOUNT": "FA452653B0C48E17",
    "Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0": "1759587778"
}
url = "https://www.mashangpa.com/api/problem-detail/5/data/"
list = []
for i in range(1,21):
    params = {
    'page':i,
    '_ts' : int(time.time()*1000)
    }
    data = {
        "xl": ctx.call('encrypt',params),
    }
    data = json.dumps(data, separators=(',', ':'))
    response = requests.post(url, headers=headers, cookies=cookies, data=data).json()
    print(response)
    list += response["current_array"]
    time.sleep(0.5)
print(sum(list))
```
## 倚天剑
#### 经过观察为简单的请求头加密分别为s和tt，并且对响应内容response进行加密。通过分析loadPage里面的源代码很容易就可以进行js还原，但是要注意在还原加密参数时不要再js里面用json还原最终结果
```js
function xxxxoooo(encryptedHex) {
    let enccc = dd.a.enc.Hex.parse(encryptedHex);
    let deccc = dd.a.AES["decr" + "ypt"]({ciphertext: enccc}, kkkk, {
        mode: dd.a.mode.CBC,
        padding: dd.a.pad.Pkcs7,
        iv: iiii,
    });
    // console.log(JSON.parse(deccc.toString(dd.a.enc.Utf8)))
    // return JSON.parse(deccc.toString(dd.a.enc.Utf8));
    return deccc.toString(dd.a.enc.Utf8)
}
function r(n, r) {
        var t = (65535 & n) + (65535 & r);
        return (n >> 16) + (r >> 16) + (t >> 16) << 16 | 65535 & t
    }
function t(n, t, o, u, e, c) {
        return r(function (n, r) {
            return n << e | n >>> 32 - e
        }(r(r(t, n), r(u, c))), o)
    }
function o(n, r, o, u, e, c, f) {
        return t(r & o | ~r & u, n, r, e, c, f)
    }
function u(n, r, o, u, e, c, f) {
        return t(r & u | o & ~u, n, r, e, c, f)
    }
function e(n, r, o, u, e, c, f) {
        return t(r ^ o ^ u, n, r, e, c, f)
    }
function c(n, r, o, u, e, c, f) {
        return t(o ^ (r | ~u), n, r, e, c, f)
    }
function a(n) {
        var r, t = [];
        for (t[(n.length >> 2) - 1] = void 0, r = 0; r < t.length; r += 1) t[r] = 0;
        var o = 8 * n.length;
        for (r = 0; r < o; r += 8) t[r >> 5] |= (255 & n.charCodeAt(r / 8)) << r % 32;
        return t
    }
function f(n, t) {
        var f, i, a, h, g;
        n[t >> 5] |= 128 << t % 32, n[14 + (t + 64 >>> 9 << 4)] = t;
        var l = 1732584193, d = -271733879, v = -1732584194, C = 271733878;
        for (f = 0; f < n.length; f += 16) d = c(d = c(d = c(d = c(d = e(d = e(d = e(d = e(d = u(d = u(d = u(d = u(d = o(d = o(d = o(d = o(a = d, v = o(h = v, C = o(g = C, l = o(i = l, d, v, C, n[f], 7, -680876936), d, v, n[f + 1], 12, -389564586), l, d, n[f + 2], 17, 606105819), C, l, n[f + 3], 22, -1044525330), v = o(v, C = o(C, l = o(l, d, v, C, n[f + 4], 7, -176418897), d, v, n[f + 5], 12, 1200080426), l, d, n[f + 6], 17, -1473231341), C, l, n[f + 7], 22, -45705983), v = o(v, C = o(C, l = o(l, d, v, C, n[f + 8], 7, 1770035416), d, v, n[f + 9], 12, -1958414417), l, d, n[f + 10], 17, -42063), C, l, n[f + 11], 22, -1990404162), v = o(v, C = o(C, l = o(l, d, v, C, n[f + 12], 7, 1804603682), d, v, n[f + 13], 12, -40341101), l, d, n[f + 14], 17, -1502002290), C, l, n[f + 15], 22, 1236535329), v = u(v, C = u(C, l = u(l, d, v, C, n[f + 1], 5, -165796510), d, v, n[f + 6], 9, -1069501632), l, d, n[f + 11], 14, 643717713), C, l, n[f], 20, -373897302), v = u(v, C = u(C, l = u(l, d, v, C, n[f + 5], 5, -701558691), d, v, n[f + 10], 9, 38016083), l, d, n[f + 15], 14, -660478335), C, l, n[f + 4], 20, -405537848), v = u(v, C = u(C, l = u(l, d, v, C, n[f + 9], 5, 568446438), d, v, n[f + 14], 9, -1019803690), l, d, n[f + 3], 14, -187363961), C, l, n[f + 8], 20, 1163531501), v = u(v, C = u(C, l = u(l, d, v, C, n[f + 13], 5, -1444681467), d, v, n[f + 2], 9, -51403784), l, d, n[f + 7], 14, 1735328473), C, l, n[f + 12], 20, -1926607734), v = e(v, C = e(C, l = e(l, d, v, C, n[f + 5], 4, -378558), d, v, n[f + 8], 11, -2022574463), l, d, n[f + 11], 16, 1839030562), C, l, n[f + 14], 23, -35309556), v = e(v, C = e(C, l = e(l, d, v, C, n[f + 1], 4, -1530992060), d, v, n[f + 4], 11, 1272893353), l, d, n[f + 7], 16, -155497632), C, l, n[f + 10], 23, -1094730640), v = e(v, C = e(C, l = e(l, d, v, C, n[f + 13], 4, 681279174), d, v, n[f], 11, -358537222), l, d, n[f + 3], 16, -722521979), C, l, n[f + 6], 23, 76029189), v = e(v, C = e(C, l = e(l, d, v, C, n[f + 9], 4, -640364487), d, v, n[f + 12], 11, -421815835), l, d, n[f + 15], 16, 530742520), C, l, n[f + 2], 23, -995338651), v = c(v, C = c(C, l = c(l, d, v, C, n[f], 6, -198630844), d, v, n[f + 7], 10, 1126891415), l, d, n[f + 14], 15, -1416354905), C, l, n[f + 5], 21, -57434055), v = c(v, C = c(C, l = c(l, d, v, C, n[f + 12], 6, 1700485571), d, v, n[f + 3], 10, -1894986606), l, d, n[f + 10], 15, -1051523), C, l, n[f + 1], 21, -2054922799), v = c(v, C = c(C, l = c(l, d, v, C, n[f + 8], 6, 1873313359), d, v, n[f + 15], 10, -30611744), l, d, n[f + 6], 15, -1560198380), C, l, n[f + 13], 21, 1309151649), v = c(v, C = c(C, l = c(l, d, v, C, n[f + 4], 6, -145523070), d, v, n[f + 11], 10, -1120210379), l, d, n[f + 2], 15, 718787259), C, l, n[f + 9], 21, -343485551), l = r(l, i), d = r(d, a), v = r(v, h), C = r(C, g);
        return [l, d, v, C]
    }
function i(n) {
        var r, t = "", o = 32 * n.length;
        for (r = 0; r < o; r += 8) t += String.fromCharCode(n[r >> 5] >>> r % 32 & 255);
        return t
    }
function g(n) {
        return unescape(encodeURIComponent(n))
    }
function l(n) {
        return function (n) {
            return i(f(a(n), 8 * n.length))
        }(g(n))
    }
function h(n) {
        var r, t, o = "0123456789abcdef", u = "";
        for (t = 0; t < n.length; t += 1) r = n.charCodeAt(t), u += o.charAt(r >>> 4 & 15) + o.charAt(15 & r);
        return u
    }
function xxoo (n, r, t) {
        return r ? t ? d(r, n) : function (n, r) {
            return h(d(n, r))
        }(r, n) : t ? l(n) : function (n) {
            return h(l(n))
        }(n)
    }
dd = {
    a: require('crypto-js')
}
let kkkk = dd.a.enc.Utf8.parse("xxxxxxxxoooooooo");
let iiii = dd.a.enc.Utf8.parse("0123456789ABCDEF");

function s() {
    let ttt = new Date().getTime();
    let  t= 1759653507488
    let token =xxoo("sssssbbbbb" + ttt)
    let hhh = {
        S: token,
        tt: ttt.toString(),
    }
    return (hhh)
    console.log(hhh)
}
// let tttt = '361d3626adcf4a361c385c8f0b39c963f0469b9c6ff6d23c7e0b145e1b885851be1cff3c2d5ef470376708d6f60fad1c4c9987e181d330ca77dc5cb91d0ab5c1680f095d61499b9023658e14181dee9f1345ad91df727ce58e869da5f59aef9df7f38b4730811ba0fe75bd3c2c95fdd5054eb1e57ee01817f2ade931100f307b497bc2b6dade4143419d9613f268f80283cdf202aba59e969fd8e4338e9678f4d5301e80407904687f5e0c68d4ba413d0a66dbc4f2758901aa4ff102be1b31aeea6d53acc884ea1abf6dba04fd8b9582027caf80badcefa2df46b1076ff883ed99aa1acd9860c7050a9e4ea36493a5b9f26ea29bd1bc5378f881856e9648ad3e977a57d33ffab33a406087a34ba40abd66859bb0f0328978c5ad97b43f3d8142724f9f051f4b276ec253da7fd33b0a3b9808d9de66d7215341d12ee729d80ba065e1c8c4ca907bc9fad229391908b230ee984ec636efaef129571c421edac6722968c25e452eafa2571e0c28f773ac5b5471883445ed951615fb5e7b167f20cc846c4736fd4c474394b07d0c7b0a4264cc02cc2dfe5599ce9410b785de0786840d522d9e29f17cce61f60ab90118fe72f224a7b202ab2dd31524fd2255331e1dfd373d3d73a65c761aebf6c53731a41e660a4075e651e44776b0a69a727b6704'
// xxxxoooo(tttt)
// console.log(tttt.length)

```
```python
import execjs
import requests
import json
import time

headers = {
    "origin": "https://www.mashangpa.com",
    "priority": "u=1, i",
    "referer": "https://www.mashangpa.com/problem-detail/5/",
    "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36 Edg/141.0.0.0"
}
with open('1.js','r',encoding='utf-8') as f:
    ctx = execjs.compile(f.read())
cookies = {
    "sessionid": "28xvqtouyogiovqb2hxbujws2rkkrruz",
    "Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0": "1758285094,1758635100,1758681400,1759586129",
    "HMACCOUNT": "FA452653B0C48E17",
    "Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0": "1759587778"
}
url = "https://www.mashangpa.com/api/problem-detail/5/data/"
list = []
for i in range(1,21):
    params = {
    'page':i,
    '_ts' : int(time.time()*1000)
    }
    data = {
        "xl": ctx.call('encrypt',params),
    }
    data = json.dumps(data, separators=(',', ':'))
    response = requests.post(url, headers=headers, cookies=cookies, data=data).json()
    print(response)
    list += response["current_array"]
    time.sleep(0.5)
print(sum(list))
```import requests
import execjs
import json


with open('1.js','r',encoding='utf-8') as f:
    ctx1 = execjs.compile(f.read())
    result1 = ctx1.call('s')
headers = {
    "accept": "*/*",
    "accept-language": "zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6",
    "cache-control": "no-cache",
    "pragma": "no-cache",
    "referer": "https://www.mashangpa.com/problem-detail/6/",
    "s": result1['S'],
    "tt":result1['tt'],
    "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36 Edg/141.0.0.0"
}
cookies = {
    "sessionid": "28xvqtouyogiovqb2hxbujws2rkkrruz",
    "Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0": "1758635100,1758681400,1759586129,1759652173",
    "HMACCOUNT": "FA452653B0C48E17",
    "Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0": "1759652183"
}
url = "https://www.mashangpa.com/api/problem-detail/6/data/"
list = []
for page in range(1,21):
    params = {
        "page": page
    }
    response = requests.get(url, headers=headers, cookies=cookies, params=params).json()
    t = str(response['t'])
    with open('1.js','r',encoding='utf-8') as f:
        ctx2 = execjs.compile(f.read())
        result2 = ctx2.call('xxxxoooo',t)
    response = json.loads(result2)
    print(response)
    list += response['current_array']
print(sum(list))
```
## 千山鸟飞绝
#### 经过观察为简单的请求头加密分别为m和ts，并且对响应内容response进行加密。通过分析loadPage里面的源代码很容易就可以进行js还原，但是要注意在还原加密参数时不要再js里面用json还原最终结果。加密eeee方法解密是xxxxoooo方法
```js
// 前半部分借鉴的阿尔法老师的 后半部分自己写的 因为再https://obf-io.deobfuscate.io/上面前部分解混淆是错误的。
const CryptoJS = require('crypto-js')
function eeee(_0x4e41fb, _0x151d45, _0x21b59a) {
    return _0x151d45 ? _0x21b59a ? _0x5333d7(_0x151d45, _0x4e41fb) : function (_0x32e6c1, _0x317277) {
      return _0x4646b5(_0x5333d7(_0x32e6c1, _0x317277));
    }(_0x151d45, _0x4e41fb) : _0x21b59a ? _0x3fdbf5(_0x4e41fb) : function (_0x5beac5) {
      return _0x4646b5(_0x3fdbf5(_0x5beac5));
    }(_0x4e41fb);
  };
function _0x4646b5(_0x15e082) {
    var _0x1ccbb8,
        _0x4bc150,
        _0x319430 = "0123456789abcdef",
        _0xca94ca = '';

    for (_0x4bc150 = 0; _0x4bc150 < _0x15e082["length"]; _0x4bc150 += 1) {
      _0x1ccbb8 = _0x15e082["charCodeAt"](_0x4bc150);
      _0xca94ca += _0x319430["charAt"](_0x1ccbb8 >>> 4 & 15) + _0x319430["charAt"](15 & _0x1ccbb8);
    }

    return _0xca94ca;
  };
function _0x3fdbf5(_0x15f5cd) {
    return function (_0x359016) {
      return _0x39f712(_0x4ca385(_0x19e0dd(_0x359016), 8 * _0x359016["length"]));
    }(_0x28dd2d(_0x15f5cd));
  };
function _0x28dd2d(_0xafa9b4) {
    return unescape(encodeURIComponent(_0xafa9b4));
  };
function _0x39f712(_0x46c2c6) {
    var _0x46b898,
        _0x5016fb = '',
        _0x3072e8 = 32 * _0x46c2c6["length"];

    for (_0x46b898 = 0; _0x46b898 < _0x3072e8; _0x46b898 += 8) {
      _0x5016fb += String["fromCharCode"](_0x46c2c6[_0x46b898 >> 5] >>> _0x46b898 % 32 & 255);
    }

    return _0x5016fb;
  };
function _0x4ca385(_0x2dc616, _0x307043) {
    var _0x5a7e07, _0xd5b683, _0x4cf87b, _0x13ac12, _0x3d4242;

    _0x2dc616[_0x307043 >> 5] |= 128 << _0x307043 % 32;
    _0x2dc616[14 + (_0x307043 + 64 >>> 9 << 4)] = _0x307043;

    var _0x2f897c = 1732584193,
        _0x58e914 = -271733879,
        _0x4fed8f = -1732584194,
        _0x16de2e = 271733878;

    for (_0x5a7e07 = 0; _0x5a7e07 < _0x2dc616["length"]; _0x5a7e07 += 16) {
      _0x58e914 = _0x4025ad(_0x58e914 = _0x4025ad(_0x58e914 = _0x4025ad(_0x58e914 = _0x4025ad(_0x58e914 = _0x456ee7(_0x58e914 = _0x456ee7(_0x58e914 = _0x456ee7(_0x58e914 = _0x456ee7(_0x58e914 = _0x2ee51e(_0x58e914 = _0x2ee51e(_0x58e914 = _0x2ee51e(_0x58e914 = _0x2ee51e(_0x58e914 = _0x37e5c4(_0x58e914 = _0x37e5c4(_0x58e914 = _0x37e5c4(_0x58e914 = _0x37e5c4(_0x4cf87b = _0x58e914, _0x4fed8f = _0x37e5c4(_0x13ac12 = _0x4fed8f, _0x16de2e = _0x37e5c4(_0x3d4242 = _0x16de2e, _0x2f897c = _0x37e5c4(_0xd5b683 = _0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07], 7, -680876936), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 1], 12, -389564586), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 2], 17, 606105819), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 3], 22, -1044525330), _0x4fed8f = _0x37e5c4(_0x4fed8f, _0x16de2e = _0x37e5c4(_0x16de2e, _0x2f897c = _0x37e5c4(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 4], 7, -176418897), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 5], 12, 1200080426), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 6], 17, -1473231341), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 7], 22, -45705983), _0x4fed8f = _0x37e5c4(_0x4fed8f, _0x16de2e = _0x37e5c4(_0x16de2e, _0x2f897c = _0x37e5c4(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 8], 7, 1770035416), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 9], 12, -1958414417), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 10], 17, -42063), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 11], 22, -1990404162), _0x4fed8f = _0x37e5c4(_0x4fed8f, _0x16de2e = _0x37e5c4(_0x16de2e, _0x2f897c = _0x37e5c4(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 12], 7, 1804603682), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 13], 12, -40341101), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 14], 17, -1502002290), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 15], 22, 1236535329), _0x4fed8f = _0x2ee51e(_0x4fed8f, _0x16de2e = _0x2ee51e(_0x16de2e, _0x2f897c = _0x2ee51e(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 1], 5, -165796510), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 6], 9, -1069501632), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 11], 14, 643717713), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07], 20, -373897302), _0x4fed8f = _0x2ee51e(_0x4fed8f, _0x16de2e = _0x2ee51e(_0x16de2e, _0x2f897c = _0x2ee51e(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 5], 5, -701558691), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 10], 9, 38016083), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 15], 14, -660478335), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 4], 20, -405537848), _0x4fed8f = _0x2ee51e(_0x4fed8f, _0x16de2e = _0x2ee51e(_0x16de2e, _0x2f897c = _0x2ee51e(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 9], 5, 568446438), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 14], 9, -1019803690), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 3], 14, -187363961), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 8], 20, 1163531501), _0x4fed8f = _0x2ee51e(_0x4fed8f, _0x16de2e = _0x2ee51e(_0x16de2e, _0x2f897c = _0x2ee51e(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 13], 5, -1444681467), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 2], 9, -51403784), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 7], 14, 1735328473), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 12], 20, -1926607734), _0x4fed8f = _0x456ee7(_0x4fed8f, _0x16de2e = _0x456ee7(_0x16de2e, _0x2f897c = _0x456ee7(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 5], 4, -378558), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 8], 11, -2022574463), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 11], 16, 1839030562), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 14], 23, -35309556), _0x4fed8f = _0x456ee7(_0x4fed8f, _0x16de2e = _0x456ee7(_0x16de2e, _0x2f897c = _0x456ee7(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 1], 4, -1530992060), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 4], 11, 1272893353), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 7], 16, -155497632), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 10], 23, -1094730640), _0x4fed8f = _0x456ee7(_0x4fed8f, _0x16de2e = _0x456ee7(_0x16de2e, _0x2f897c = _0x456ee7(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 13], 4, 681279174), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07], 11, -358537222), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 3], 16, -722521979), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 6], 23, 76029189), _0x4fed8f = _0x456ee7(_0x4fed8f, _0x16de2e = _0x456ee7(_0x16de2e, _0x2f897c = _0x456ee7(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 9], 4, -640364487), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 12], 11, -421815835), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 15], 16, 530742520), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 2], 23, -995338651), _0x4fed8f = _0x4025ad(_0x4fed8f, _0x16de2e = _0x4025ad(_0x16de2e, _0x2f897c = _0x4025ad(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07], 6, -198630844), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 7], 10, 1126891415), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 14], 15, -1416354905), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 5], 21, -57434055), _0x4fed8f = _0x4025ad(_0x4fed8f, _0x16de2e = _0x4025ad(_0x16de2e, _0x2f897c = _0x4025ad(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 12], 6, 1700485571), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 3], 10, -1894986606), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 10], 15, -1051523), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 1], 21, -2054922799), _0x4fed8f = _0x4025ad(_0x4fed8f, _0x16de2e = _0x4025ad(_0x16de2e, _0x2f897c = _0x4025ad(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 8], 6, 1873313359), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 15], 10, -30611744), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 6], 15, -1560198380), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 13], 21, 1309151649), _0x4fed8f = _0x4025ad(_0x4fed8f, _0x16de2e = _0x4025ad(_0x16de2e, _0x2f897c = _0x4025ad(_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e, _0x2dc616[_0x5a7e07 + 4], 6, -145523070), _0x58e914, _0x4fed8f, _0x2dc616[_0x5a7e07 + 11], 10, -1120210379), _0x2f897c, _0x58e914, _0x2dc616[_0x5a7e07 + 2], 15, 718787259), _0x16de2e, _0x2f897c, _0x2dc616[_0x5a7e07 + 9], 21, -343485551);
      _0x2f897c = _0x42fcff(_0x2f897c, _0xd5b683);
      _0x58e914 = _0x42fcff(_0x58e914, _0x4cf87b);
      _0x4fed8f = _0x42fcff(_0x4fed8f, _0x13ac12);
      _0x16de2e = _0x42fcff(_0x16de2e, _0x3d4242);
    }

    return [_0x2f897c, _0x58e914, _0x4fed8f, _0x16de2e];
  };
function _0x19e0dd(_0xe66aef) {
    var _0x286c6a,
        _0x53584a = [];

    for (_0x53584a[(_0xe66aef["length"] >> 2) - 1] = void 0, _0x286c6a = 0; _0x286c6a < _0x53584a["length"]; _0x286c6a += 1) {
      _0x53584a[_0x286c6a] = 0;
    }

    var _0x29afd4 = 8 * _0xe66aef["length"];

    for (_0x286c6a = 0; _0x286c6a < _0x29afd4; _0x286c6a += 8) {
      _0x53584a[_0x286c6a >> 5] |= (255 & _0xe66aef["charCodeAt"](_0x286c6a / 8)) << _0x286c6a % 32;
    }

    return _0x53584a;
  };
function _0x4025ad(_0x551614, _0x3736d8, _0x3091a9, _0x5c8ce5, _0x29a596, _0x3e1797, _0x2a5aa9) {
    return _0x3d57b3(_0x3091a9 ^ (_0x3736d8 | ~_0x5c8ce5), _0x551614, _0x3736d8, _0x29a596, _0x3e1797, _0x2a5aa9);
  };
function _0x456ee7(_0x1ccf9c, _0xf3008c, _0x21c7c7, _0xa84375, _0xa121be, _0x5a76ec, _0x47fb6e) {
    return _0x3d57b3(_0xf3008c ^ _0x21c7c7 ^ _0xa84375, _0x1ccf9c, _0xf3008c, _0xa121be, _0x5a76ec, _0x47fb6e);
  };
function _0x2ee51e(_0x398952, _0x441c4e, _0x4c89ff, _0x5d836a, _0x967345, _0x474483, _0x369a2d) {
    return _0x3d57b3(_0x441c4e & _0x5d836a | _0x4c89ff & ~_0x5d836a, _0x398952, _0x441c4e, _0x967345, _0x474483, _0x369a2d);
  };
function _0x37e5c4(_0x4c79ac, _0x1bc981, _0x372a6a, _0x27faff, _0x563eb7, _0x118215, _0x4d4537) {
    return _0x3d57b3(_0x1bc981 & _0x372a6a | ~_0x1bc981 & _0x27faff, _0x4c79ac, _0x1bc981, _0x563eb7, _0x118215, _0x4d4537);
  };
function _0x3d57b3(_0x37dd5c, _0x241fbb, _0x41c5da, _0x29f9bb, _0x5c4414, _0x461224) {
    return _0x42fcff(function (_0x5961b3, _0x5d9435) {
      return _0x5961b3 << _0x5c4414 | _0x5961b3 >>> 32 - _0x5c4414;
    }(_0x42fcff(_0x42fcff(_0x241fbb, _0x37dd5c), _0x42fcff(_0x29f9bb, _0x461224))), _0x41c5da);
  }
function _0x42fcff(_0x2a4dbf, _0x1aac01) {
    var _0x4c862c = (65535 & _0x2a4dbf) + (65535 & _0x1aac01);

    return (_0x2a4dbf >> 16) + (_0x1aac01 >> 16) + (_0x4c862c >> 16) << 16 | 65535 & _0x4c862c;
  };

function get_data() {
  let _0x2498e1 = new Date()["getTime"](),
      _0x48003c = eeee("xialuo" + _0x2498e1);
  let m = _0x48003c;
  let ts = _0x2498e1;
  let x= encodeURIComponent(CryptoJS["SHA256"](_0x48003c + "xxoo"));
  return {
  'm': m,
  'ts': ts.toString(),
  'x': x}
}

const Oe = {
  a: CryptoJS
};
dd = Oe;
let kkkk = dd.a.enc.Utf8.parse("xxxxxxxxoooooooo");
let iiii = dd.a.enc.Utf8.parse("0123456789ABCDEF");
function xxxxoooo(M) {
  let Y = dd.a.enc.Hex.parse(M);
  const x = {
    ciphertext: Y
  };
  let I = dd.a.AES.decrypt(x, kkkk, {
    'mode': dd.a.mode.CBC,
    'padding': dd.a.pad.Pkcs7,
    'iv': iiii
  });
  return I.toString(dd.a.enc.Utf8);
}

function get_response(r){
    const B = xxxxoooo(r);
    return B;
}

```
```python
import requests
import execjs
import json
with open('4.js', 'r', encoding='utf-8') as f:
    ctx = execjs.compile(f.read())
    result = ctx.call('get_data')
headers = {
    "accept": "application/json, text/javascript, */*; q=0.01",
    "accept-language": "zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6",
    "cache-control": "no-cache",
    "m": result['m'],
    "pragma": "no-cache",
    "priority": "u=1, i",
    "referer": "https://www.mashangpa.com/problem-detail/7/",
    "ts": result['ts'],
    "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36 Edg/141.0.0.0",
    "x-requested-with": "XMLHttpRequest"
}
cookies = {
    "sessionid": "28xvqtouyogiovqb2hxbujws2rkkrruz",
    "Hm_lvt_0d2227abf9548feda3b9cb6fddee26c0": "1758635100,1758681400,1759586129,1759652173",
    "HMACCOUNT": "FA452653B0C48E17",
    "Hm_lpvt_0d2227abf9548feda3b9cb6fddee26c0": "1759657690"
}
url = "https://www.mashangpa.com/api/problem-detail/7/data/"
list = []
for page in range(1, 21):
    params = {
        "page": "2",
        "x": result['x'],
    }
    response = requests.get(url, headers=headers, cookies=cookies, params=params)
    resp = response.json()['r']
    with open('4.js', 'r', encoding='utf-8') as f:
        ctx = execjs.compile(f.read())
        response = ctx.call('get_response',resp )
        response = json.loads(response)
        print(response)
        list += response['current_array']
print(sum(list))
```
